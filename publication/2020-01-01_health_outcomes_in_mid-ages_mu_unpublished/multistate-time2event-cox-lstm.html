<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.329">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lakshmi K. Raut">
<meta name="dcterms.date" content="2023-01-19">
<meta name="description" content="The paper compares performances of a statistical multistate time to event model and a long short term memory (LSTM) recurrent neural network (RNN) model in forecasting sequentially the health outcomes over the life span.">

<title>Health Outcomes in Mid-Ages: Multistate time to event Statistical Models versus Long Short Term Memory (LSTM) Recurrent Neural Network (RNN) Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="Multistate-time2event-cox-LSTM_files/libs/clipboard/clipboard.min.js"></script>
<script src="Multistate-time2event-cox-LSTM_files/libs/quarto-html/quarto.js"></script>
<script src="Multistate-time2event-cox-LSTM_files/libs/quarto-html/popper.min.js"></script>
<script src="Multistate-time2event-cox-LSTM_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Multistate-time2event-cox-LSTM_files/libs/quarto-html/anchor.min.js"></script>
<link href="Multistate-time2event-cox-LSTM_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Multistate-time2event-cox-LSTM_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Multistate-time2event-cox-LSTM_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Multistate-time2event-cox-LSTM_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Multistate-time2event-cox-LSTM_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<link rel="stylesheet" href="raut-html-style1.css">
</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Health Outcomes in Mid-Ages: Multistate time to event Statistical Models versus Long Short Term Memory (LSTM) Recurrent Neural Network (RNN) Models</h1>
                  <div>
        <div class="description">
          <p>The paper compares performances of a statistical multistate time to event model and a long short term memory (LSTM) recurrent neural network (RNN) model in forecasting sequentially the health outcomes over the life span.</p>
        </div>
      </div>
                </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      Lakshmi K. Raut 
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Visiting Fellow, University of Chicago
            </p>
        </div>
      </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 19, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="abstract-title">Abstract</div>
      Health outcomes such as serious diseases, disability and death develop sequentially over one’s life span. Genetic and epigenetic factors, and health related behaviors throughout one’s life condition those health outcomes. Some individuals develop one or more diseases and their health deteriorate faster, worsening their quality of lives and survival probabilities. The models in health economics literature formulate progression of health outcomes over the life span using the multistate time to event framework, and estimate the effects of the above mitigating factors on probability of transitions from one health state to another. The sequential nature of health progression is captured in the Markovian structure. Markov chain models have short memory, i.e., these models assume that given the current health outcome, the past does not influence the probability of transition to another health outcome. Many chronic diseases such as cancers and heart diseases manifest as a result of long lagged past health behaviors. Markov chain models are limited in capturing these effects. More recently, long short term memory (LSTM) recurrent neural network (RNN) models are developed in the machine (deep) learning literature that keep track of important features from the past inputs in its memory cells, which the model determine important in the ‘context’ of the future outcomes. These models are generally applied to natural language processing, creating audio streams, and video subtitling. In this paper, I adapt the existing LSTM-RNN models for the prediction of sequential health outcomes in mid-ages. I first compare the merits and shortcomings of these two approaches and then use the Health and Retirement Study (HRS) data to compare their performances in predicting sequential health outcomes.<br><strong>JEL Classifications:</strong> I12, C41, C51.<br><strong>Keywords:</strong> Forecasting health outcomes, multistate time-to-event model, long short term memory (LSTM) recurrent neural network (RNN) model. <br><strong>One-liner:</strong> The paper compares performances of a statistical multistate time to event model and a long short term memory (LSTM) recurrent neural network (RNN) model in forecasting sequentially the health outcomes over the life span.
    </div>
  </div>
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#sec-sec1" id="toc-sec-sec1" class="nav-link active" data-scroll-target="#sec-sec1"><span class="toc-section-number">1</span>  Introduction</a></li>
  <li><a href="#sec-sec2" id="toc-sec-sec2" class="nav-link" data-scroll-target="#sec-sec2"><span class="toc-section-number">2</span>  Statistical multi-state model of health outcomes process</a>
  <ul class="collapse">
  <li><a href="#aalen-johansen-estimator-of-transition-probabilities" id="toc-aalen-johansen-estimator-of-transition-probabilities" class="nav-link" data-scroll-target="#aalen-johansen-estimator-of-transition-probabilities"><span class="toc-section-number">2.1</span>  Aalen-Johansen Estimator of Transition Probabilities</a></li>
  </ul></li>
  <li><a href="#sec-sec3" id="toc-sec-sec3" class="nav-link" data-scroll-target="#sec-sec3"><span class="toc-section-number">3</span>  The data set and the variables</a>
  <ul class="collapse">
  <li><a href="#variables" id="toc-variables" class="nav-link" data-scroll-target="#variables"><span class="toc-section-number">3.1</span>  Variables</a></li>
  <li><a href="#statistical-results" id="toc-statistical-results" class="nav-link" data-scroll-target="#statistical-results"><span class="toc-section-number">3.2</span>  Statistical Results</a></li>
  </ul></li>
  <li><a href="#sec-sec4" id="toc-sec-sec4" class="nav-link" data-scroll-target="#sec-sec4"><span class="toc-section-number">4</span>  Long-short memory (LSTM) recurrent neural network (RNN) model of health outcomes process</a>
  <ul class="collapse">
  <li><a href="#sec-sec4N" id="toc-sec-sec4N" class="nav-link" data-scroll-target="#sec-sec4N"><span class="toc-section-number">4.1</span>  The basics of neural network</a></li>
  <li><a href="#previous-neural-network-models-of-survival-analysis" id="toc-previous-neural-network-models-of-survival-analysis" class="nav-link" data-scroll-target="#previous-neural-network-models-of-survival-analysis"><span class="toc-section-number">4.2</span>  Previous neural network models of survival analysis</a></li>
  <li><a href="#formulation-within-recurrent-neural-network-with-lstm" id="toc-formulation-within-recurrent-neural-network-with-lstm" class="nav-link" data-scroll-target="#formulation-within-recurrent-neural-network-with-lstm"><span class="toc-section-number">4.3</span>  Formulation within Recurrent Neural Network with LSTM</a></li>
  <li><a href="#lstm-memory-cell" id="toc-lstm-memory-cell" class="nav-link" data-scroll-target="#lstm-memory-cell"><span class="toc-section-number">4.4</span>  LSTM memory cell</a></li>
  </ul></li>
  <li><a href="#sec-sec5" id="toc-sec-sec5" class="nav-link" data-scroll-target="#sec-sec5"><span class="toc-section-number">5</span>  Prediction and performance of the model</a></li>
  <li><a href="#sec-sec6" id="toc-sec-sec6" class="nav-link" data-scroll-target="#sec-sec6"><span class="toc-section-number">6</span>  Conclusion</a></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix">Appendix</a></li>
  <li><a href="#mlp-learning-algorithm" id="toc-mlp-learning-algorithm" class="nav-link" data-scroll-target="#mlp-learning-algorithm">MLP learning algorithm</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">




<!-- HIDE
#### Abstract {-}

Health outcomes such as serious diseases, disability and death develop sequentially over one’s life span. Genetic and epigenetic factors, and health related behaviors throughout one’s life condition those health outcomes. Some individuals develop one or more diseases and their health deteriorate faster, worsening their quality of lives and survival probabilities. The models in health economics literature formulate progression of health outcomes over the life span using the multistate time to event framework, and estimate the effects of the above mitigating factors on probability of transitions from one health state to another. The sequential nature of health progression is captured in the Markovian structure. Markov chain models have short memory, i.e., these models assume that given the current health outcome, the past does not influence the probability of transition to another health outcome. Many chronic diseases such as cancers and heart diseases manifest as a result of long lagged past health behaviors. Markov chain models are limited in capturing these effects. More recently, long short term memory (LSTM) recurrent neural network (RNN) models are developed in the machine (deep) learning literature that keep track of important features from the past inputs in its memory cells, which the model determine important in the ‘context’ of the future outcomes. These models are generally applied to natural language processing, creating audio streams, and video subtitling. In this paper, I adapt the existing LSTM-RNN models for the prediction of sequential health outcomes in mid-ages. I first compare the merits and shortcomings of these two approaches and then use the Health and Retirement Study (HRS) data to compare their performances in predicting sequential health outcomes.
<br>
**JEL Classifications:** I12, C41, C51.
<br>
**Keywords:** Forecasting health outcomes, multistate time-to-event model, long short term memory (LSTM) recurrent neural network (RNN) model.
<br>
**One-liner:** The paper compares performances of a statistical multistate time to event model and a long short term memory (LSTM) recurrent neural network (RNN) model in forecasting sequentially the health outcomes over the life span.

 
**Acknowledgement and disclaimer**^[Draft prepared for presentation at the ASSA 2020 Annual Meeting, January 3 - 5, 2020, San Diego, California, USA. I got many insightful comments from Han Altae-Tran at MIT, John Phillips at NIH, and comments from the discussant and the audience. Thanks. <br> **Disclaimer&#58;** The views, thoughts, and opinions expressed in the paper belong solely to the author, and do not necessarily represent the views of any institution, other group or individual.]

 HIDE ENDS -->
<section id="sec-sec1" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>The path through various health outcomes such as serious diseases, disability and death develop sequentially over one’s life span. Many factors such as genetic and epigenetic factors, and health related behaviors throughout one’s life condition those health outcomes. Some individuals develop one or more diseases and their health deteriorate faster, worsening their quality of lives and survival probabilities, while others have slower aging process. The biology of aging process determines how those factors affect aging at the cellular level. In this paper, with insights from the biology literature, I use statistical and neural network models for predicting and estimating the transition probabilities between health states and the times they spend in a health state before transiting to another health state for individuals in their mid ages. While the framework I develop in the paper is applicable to many other heath outcomes such as incidence of cardiovascular and immune diseases, I focus on one health outcome of interest—any of the disabilities that qualifies for a public disability insurance program—with death as a competing risk health outcome. Death is a competing risk heath outcome in the sense that once dead, one cannot be at risk of disability, or as a matter of fact, any other health outcome of interest.</p>
<p><em>The main issues I address in this paper are:</em> What kind of aging process and what conditioning factors for it the biology literature recommends? Which type of model—a multistate statistical model, a feedforward multilayer perceptron (MLP) type of neural network model, or a long short memory (LSTM) recurrent neural network (RNN) model—that is better suited for prediction and estimation of transition probabilities among health states, taking into account the effect of various covariates (the conditioning factors)? Which model can estimate the effect of various conditioning factors and their relative importance on the type of health trajectory one follows?</p>
<p>I will not get into the details of the biomedical literature on these issues. Here I will point out the main insights from my reviews elsewhere, <span class="citation" data-cites="Raut_2019 Raut_2019a">(<a href="#ref-Raut_2019" role="doc-biblioref">Raut 2019a</a>, <a href="#ref-Raut_2019a" role="doc-biblioref">2019b</a>)</span>. Similar to the literature of behavioral genetics of personality and intelligence, the <em>nature-nurture</em> controversy exists in the health literature: Is it all nature (i.e., all genetics or genome) or is it all nurture (i.e., all epigenetics or epigenome modulated by the environment and health related individual behaviors) that determines the progression of health over the life span of an individual? The consensus so far is that it is neither the nature nor the nurture, it is a combination of the two that determines health developments over one’s life-span. The research so far found that certain genetic make-ups (i.e., certain sequences of DNA) predispose one to certain diseases, (<span class="citation" data-cites="Barondes_1999_Book Khoury.etal_2009 Bookman.etal_2011">(<a href="#ref-Barondes_1999_Book" role="doc-biblioref">Barondes 1999</a>; <a href="#ref-Khoury.etal_2009" role="doc-biblioref">Khoury et al. 2009</a>; <a href="#ref-Bookman.etal_2011" role="doc-biblioref">Bookman et al. 2011</a>)</span>), but the epigenetic inputs—especially at the very early stage of life, i.e.&nbsp;in the womb, but not the least at later stages of life—are also very important determinants of life expectancy and quality of life. The biomedical research so far has not found genes that are responsible for aging and age related diseases, leading to early disability and mortality. The twenty-first century biomedical research emphasizes more on the epigenetic factors than the genetic factors to explain the pattern of health developments over the life-span.</p>
<p>At the cellular level, aging means cellular senescence—i.e., after a certain number of cell divisions, it stops dividing or have defective replications, causing tissues or organs to increasingly deteriorate over time. Senescence leads to incidence of degenerative diseases. It is generally observed that women live longer than men and those with better life styles in terms of smoking, exercising and diets delay the aging process (for evidence, see <span class="citation" data-cites="Blair.etal_1989 Vaupel_2010 Austad.Fischer_2016 Zarulli.etal_2018">(<a href="#ref-Blair.etal_1989" role="doc-biblioref">Blair et al. 1989</a>; <a href="#ref-Vaupel_2010" role="doc-biblioref">Vaupel 2010</a>; <a href="#ref-Austad.Fischer_2016" role="doc-biblioref">Austad and Fischer 2016</a>; <a href="#ref-Zarulli.etal_2018" role="doc-biblioref">Zarulli et al. 2018</a>)</span>). This line of biological inquiry led to explore the (cellular) molecular mechanism of aging process and to find biomarkers of aging that can be used to diagnose, monitor, and improve the age related physiological decline and disease. A good indicator of the aging process at the cellular level is the rate of decay in the telomere length. Telomeres are the caps at the end of chromosomes in a DNA sequence. They look like the plastic caps at the end of shoelaces. The main function of telomeres is to protect cells preserving the genetic content within each chromosome during cell divisions. Unfortunately, the telomere length shortens in the course of each cycle of chromosomal replication during cell division, reaching the Hayflick limit (about 40 to 60 cell divisions, <span class="citation" data-cites="Hayflick_1965">Hayflick (<a href="#ref-Hayflick_1965" role="doc-biblioref">1965</a>)</span>) with a critically short telomere length, after which the cells stop dividing or divide with chromosomal abnormalities. The rate of shortening of the telomere length is modulated by telomerase enzyme. Why the rate of decay in telomere length varies for individuals is an active area of biomedical research and the mechanism for it is not yet fully understood. Many studies find that higher stress of any kind— psychological, financial, social and chemical—is strongly associated with higher oxidative stress, lower level of telomerase enzyme, and shorter telomere length. Furthermore, shorter telomere length is associated with health related phenotypes of poorer health and higher risks for cardiovascular and immune diseases (see, <span class="citation" data-cites="Epel.etal_2004 Shalev.etal_2013 DiLoreto.Murphy_2015 Shalev.Belsky_2016 Simons.etal_2016">(<a href="#ref-Epel.etal_2004" role="doc-biblioref">Epel et al. 2004</a>; <a href="#ref-Shalev.etal_2013" role="doc-biblioref">Shalev et al. 2013</a>; <a href="#ref-DiLoreto.Murphy_2015" role="doc-biblioref">DiLoreto and Murphy 2015</a>; <a href="#ref-Shalev.Belsky_2016" role="doc-biblioref">Shalev and Belsky 2016</a>; <a href="#ref-Simons.etal_2016" role="doc-biblioref">Simons et al. 2016</a>)</span>).</p>
<p>More recently emerged second line of biomedical research on aging and aging related diseases explores the epigenetic (which literally means on top of genetic) mechanism for these life-cycle processes. (See for instance, <span class="citation" data-cites="Alisch.etal_2012 Barres.Zierath_2011 Boks.etal_2009 Esteller_2008 Hannum.etal_2013 Horvath_2013">(<a href="#ref-Alisch.etal_2012" role="doc-biblioref">Alisch et al. 2012</a>; <a href="#ref-Barres.Zierath_2011" role="doc-biblioref">Barres and Zierath 2011</a>; <a href="#ref-Boks.etal_2009" role="doc-biblioref">Boks et al. 2009</a>; <a href="#ref-Esteller_2008" role="doc-biblioref">Esteller 2008</a>; <a href="#ref-Hannum.etal_2013" role="doc-biblioref">Hannum et al. 2013</a>; <a href="#ref-Horvath_2013" role="doc-biblioref">Horvath 2013</a>)</span>).</p>
<p>The above literature emphasizes that aging and age related diseases are associated with shortening of telomere length and changes in global methylation, and that stress, smoking, drinking, chemical misuse, physical exercising, and diet are important modulators for these changes. The question remains, what are the critical periods or the developmental milestones in life-cycle that program the motions of health developments over the life-span of an individual?</p>
<p>Research along this line began with the striking findings of <span class="citation" data-cites="Barker_1990 Barker_1998">(<a href="#ref-Barker_1990" role="doc-biblioref">Barker 1990</a>, <a href="#ref-Barker_1998" role="doc-biblioref">1998</a>)</span> and later of <span class="citation" data-cites="Gluckman.etal_2008">Gluckman et al. (<a href="#ref-Gluckman.etal_2008" role="doc-biblioref">2008</a>)</span>. They found strong associations between birth weight and many later life chronic diseases, including hypertension, coronary artery disease, type 2 diabetes, and osteoporosis. Many other studies find that much of health developments in later life is determined very early in life, during the prenatal period right after conception, i.e.&nbsp;in the womb. Sometimes it is said in social sciences that inequality begins in the womb. The effect of an environmental stress in the womb on later life diseases and developmental outcomes is known as <em>programming</em>. <span class="citation" data-cites="Gluckman.etal_2008">Gluckman et al. (<a href="#ref-Gluckman.etal_2008" role="doc-biblioref">2008</a>)</span> observes that ``like the long latency period between an environmental trigger and the onset of certain cancers, the etiology of many later life diseases such as cardiovascular disease, metabolic disease, or osteoporosis originate as early as in the intrauterine development and the influence of environments that created by the mother.’’ For more empirical evidence for the developmental origin of later life diseases, see <span class="citation" data-cites="Barker_2007 Thornburg.etal_2010">(<a href="#ref-Barker_2007" role="doc-biblioref">Barker 2007</a>; <a href="#ref-Thornburg.etal_2010" role="doc-biblioref">Thornburg et al. 2010</a>)</span>. The papres by <span class="citation" data-cites="Kanherkar.etal_2014 Barbara.etal_2017">(<a href="#ref-Kanherkar.etal_2014" role="doc-biblioref">Kanherkar, Bhatia-Dey, and Csoka 2014</a>; <a href="#ref-Barbara.etal_2017" role="doc-biblioref">Barbara, Abdilla, and Calleja-Agius 2017</a>)</span> provide detailed descriptions of the biological process of development of life and health, starting from conception. They explain how the global DNA demethylation of the fertilized egg right after conception creates an epigenetic “clean slate” to start a new life, followed by rapid remythylation to reprogram the maternal and paternal genomes to create epigenetic configurations in the fetus which rapidly produce specialized cells of the body with cell divisions. The environment provided in mother’s womb during those times has long-term effects on the child’s later cognitive and other health developments. While inputs at early milestone ages are important for later age health, healthy living and good healthcare are still important for maintaining health in mid ages.</p>
<!-- ============================ -->
<p>Studies in social sciences find that low socio-economic status (SES) are associated with inflammation, metabolic dysregulation, and various chronic and age-related diseases such as type 2 diabetes, coronary heart disease, stroke, and dementia, and that low SES create epigenetic changes in individuals that lead to faster biological aging even after controlling for health-related behaviors such as diet, exercise, smoking, alcohol consumption, or having health insurance, see for evidence, <span class="citation" data-cites="Simons.etal_2016">Simons et al. (<a href="#ref-Simons.etal_2016" role="doc-biblioref">2016</a>)</span>. The study by <span class="citation" data-cites="Karakus.Patton_2011">Karakus and Patton (<a href="#ref-Karakus.Patton_2011" role="doc-biblioref">2011</a>)</span> uses the Health and Retirement Study data and after controlling for education, race, income, health risk indicators like BMI and smoking, functional limitations like gross motor index, health limitations for work, and income, they find depression at baseline leads to significantly higher risk for developing diabetes, heart problems, and arthritis and no significant effect on developing cancer during the 12 years follow-up period. <span class="citation" data-cites="Renna_2008">Renna (<a href="#ref-Renna_2008" role="doc-biblioref">2008</a>)</span> uses National Longitudinal Survey of Youth data to find no significant effect of alchohol use on labor market outcomes such as on earnings or hours of work. <span class="citation" data-cites="Seib.etal_2014">Seib et al. (<a href="#ref-Seib.etal_2014" role="doc-biblioref">2014</a>)</span> collected data on a sample of older women in Australia and found that severe traumatic life events create strong stress levels that influence them to have unhealthy living and diet measured by BMI and develop stronger and earlier health problems. <span class="citation" data-cites="Conti.etal_2009">Conti, Berndt, and Frank (<a href="#ref-Conti.etal_2009" role="doc-biblioref">2009</a>)</span> utilize the CES-D data in the Health and Retirement Study dataset to construct a measure of depression, and find that depression of men and women have significant negative effect on employment status, early retirement, and application for DI/SSI benefits. <!-- ============================ --></p>
<p>Using insights from the above literature, I formulate a finite state continuous time stochastic process model of disablement process. I postulate that as individuals age, the homeostatic regulatory mechanism that controls physiological systems—respiratory, cardiovascular, neuroendocrine, immune, and metabolic—becomes more and more fragile in its ability to face internal and external stressors, leading to early occurrence of disease, disability and death. I use available bio-markers (such as BMI, CES-D, cognition) and health related behaviors such as smoking, and vigorous exercising along the life-course to explain how they affect the risk of chronic diseases, disabilities and death.<br>
A multistate stochastic process framework is useful to study the effects of various covariates—the covariates that may be different for different intermediate health states—on the risks of disability and death.</p>
<p>The statistical models for estimation of transition probabilities are based on Markov processes and assume that transition intensities of these processes have Cox proportional hazard specifications, see for instance (<span class="citation" data-cites="Aalen.Johansen_1978 Andersen.etal_1993_Book Andersen.Perme_2008 Crowther.Lambert_2017 Fleming_1978a">(<a href="#ref-Aalen.Johansen_1978" role="doc-biblioref">Aalen and Johansen 1978</a>; <a href="#ref-Andersen.etal_1993_Book" role="doc-biblioref">Andersen et al. 1993</a>; <a href="#ref-Andersen.Perme_2008" role="doc-biblioref">Andersen and Perme 2008</a>; <a href="#ref-Crowther.Lambert_2017" role="doc-biblioref">Crowther and Lambert 2017</a>; <a href="#ref-Fleming_1978a" role="doc-biblioref">Fleming 1978</a>)</span>). Markov models have short memories and proportionality assumption imposes serious limitations on the structure of the model, which could be far from the functional form of the true data generating process. Neural network models relax these limitations.</p>
<p>It is known that a feedforward multilayer perceptron (MLP), also known as a feedforward deep learning model, with a sufficient number of neurons in the hidden layer can approximate any function as closely as desired. That is, an MLP is one of the best `universal function approximator’ (<span class="citation" data-cites="Hornik.etal_1989">Hornik, Stinchcombe, and White (<a href="#ref-Hornik.etal_1989" role="doc-biblioref">1989</a>)</span>). A few papers—<span class="citation" data-cites="Faraggi.Simon_1995 Biganzoli.etal_1998 Katzman.etal_2018 Lee.etal_2018 Ranganath.etal_2016">(<a href="#ref-Faraggi.Simon_1995" role="doc-biblioref">Faraggi and Simon 1995</a>; <a href="#ref-Biganzoli.etal_1998" role="doc-biblioref">Biganzoli et al. 1998</a>; <a href="#ref-Katzman.etal_2018" role="doc-biblioref">Katzman et al. 2018</a>; <a href="#ref-Lee.etal_2018" role="doc-biblioref">Lee et al. 2018</a>; <a href="#ref-Ranganath.etal_2016" role="doc-biblioref">Ranganath et al. 2016</a>)</span>– used feedforward MLP networks to compute the survival probabilities when there is only one possible transition between two health states—alive and death– with the exception of <span class="citation" data-cites="Lee.etal_2018">Lee et al. (<a href="#ref-Lee.etal_2018" role="doc-biblioref">2018</a>)</span> who studied competing risks, by breaking death into various causes of death. <span class="citation" data-cites="Katzman.etal_2018">Katzman et al. (<a href="#ref-Katzman.etal_2018" role="doc-biblioref">2018</a>)</span> introduced more general non-linearity of of the covariate effects, but still kept the Cox proportionality assumption. <span class="citation" data-cites="Ranganath.etal_2016">Ranganath et al. (<a href="#ref-Ranganath.etal_2016" role="doc-biblioref">2016</a>)</span> assumed parametric form for the baseline hazard function as compared to the non-parametric form in Cox model, but they made the covariate effects nonlinear. <span class="citation" data-cites="Ren.etal_2019">Ren et al. (<a href="#ref-Ren.etal_2019" role="doc-biblioref">2019</a>)</span> consider a recurrent neural network, but the covariates are time-fixed at the initial time step. They also restricted to only one transition, i.e., a two-state model. None of these models deals with sequential framework where new information arise with time steps and update the previously estimated transition probability estimates. In these models, all the inputs from the past, present and the future times in the sample determine current probabilities. These models, with the exception of <span class="citation" data-cites="Ren.etal_2019">Ren et al. (<a href="#ref-Ren.etal_2019" role="doc-biblioref">2019</a>)</span> although with other serious limitations, have no ways to store information learned from the past inputs. After training these models, when new data arrive, these models cannot use this new data to update the predicted probabilities without losing information in the early periods.</p>
<p>A recurrent neural network (RNN) uses feedback connections or self connection of neurons in the hidden layer, and thus is capable of storing important information learned in the past in these recurrent neurons. Like an MLP is a universal function approximator, an RNN has the similar nice property that with sufficiently large number of hidden recurrent neurons, an RNN can approximate any sequence-to-sequence mapping (<span class="citation" data-cites="Graves.etal_2014 Hammer_2000 Siegelmann.Sontag_1992">(<a href="#ref-Graves.etal_2014" role="doc-biblioref">Graves, Wayne, and Danihelka 2014</a>; <a href="#ref-Hammer_2000" role="doc-biblioref">Hammer 2000</a>; <a href="#ref-Siegelmann.Sontag_1992" role="doc-biblioref">Siegelmann and Sontag 1992</a>)</span>). These models have shared weights between time-steps and in the input and output layers, as a result when new data arrive after training the model, it can use all the past important information learned from the past to this new data point and predict the future probabilities in the light of this new data. Since training such models involve computation of gradients using backpropagation through time, it involves multiplication of numbers less than one many times, leading to vanishing gradient problem. In these scenarios, it cannot keep useful information in memory from the long time back. Overcoming these problems led to a few modifications of the RNN framework. The most successful of them is the long short memory (LSTM) RNN model introduced by <span class="citation" data-cites="Hochreiter.Schmidhuber_1997">Hochreiter and Schmidhuber (<a href="#ref-Hochreiter.Schmidhuber_1997" role="doc-biblioref">1997</a>)</span>. For more on LSTM-RNN models, see <span class="citation" data-cites="Graves_2012_Book">Graves (<a href="#ref-Graves_2012_Book" role="doc-biblioref">2012</a>)</span>. I use this LSTM-RNN model for prediction of time-to-event probabilies of health outcomes. Another problem is with the training data size. To obtain good predictive performance, these models require a large number of training examples. In drug discovery problems or with surveys or lab experiements, obtaining large number of examples is costly. To overcome small data problem, <span class="citation" data-cites="Altae-Tran_2016 Altae-Tran.etal_2017">(<a href="#ref-Altae-Tran_2016" role="doc-biblioref">Altae-Tran 2016</a>; <a href="#ref-Altae-Tran.etal_2017" role="doc-biblioref">Altae-Tran et al. 2017</a>)</span> introduced further refinement of the LSTM-RNN framework. I do not adopt such modifications. In this paper, I use the original LSTM-RNN model specified in <span class="citation" data-cites="Graves_2012_Book">Graves (<a href="#ref-Graves_2012_Book" role="doc-biblioref">2012</a>)</span> and implemented in Keras module of Tensorflow 2.0 for Python package.</p>
<p>The rest of the paper is organized as follows. In <a href="#sec-sec2">Section&nbsp;2</a>, I describe the econometric specification of the maultistate stochastic process and describe estimation issues. In <a href="#sec-sec3">Section&nbsp;3</a>, I describe the Health and Retirement Study data set and the variables that I use in estimation in both frameworks. In <a href="#sec-sec4">Section&nbsp;4</a>, I describe the recurrent neural network with LSTM memory cells that I use to extend the multistate Cox model of health outcomes process. In <a href="#sec-sec5">Section&nbsp;5</a>, I describe the performance criteria that I use to compare the performance of the models used in this study. <a href="#sec-sec6">Section&nbsp;6</a> concludes the paper.</p>
<!-- 
# The biological model of health outcomes process {#sec-sec2}
@Koene.etal_2016
[@Awang.etal_2018;@Fried.etal_2004;@Holliday_1997;@Kirkwood.Austad_2000;@Levine.etal_2015;@Marks_1997]
-->
</section>
<section id="sec-sec2" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Statistical multi-state model of health outcomes process</h1>
<p>The goal is to formulate and then estimate an econometric model of paths to enter disability rolls. An individual can be on the disability rolls if the individual has a qualifying disability before reaching age 65 and has not died before applying for disability benefits. I assume that an individual’s getting on the disability rolls is a terminal event, i.e., the individual does not move to normal or diseased health states. After reaching this state, the individual is not followed any further. A competing risk for getting on the rolls is death before age 65. This is a competing risk because an individual cannot be at risk for disability enrollment if the individual is already dead and thus not at risk to get on the disability rolls. The individual is not followed after the event of death because our primary interest is the event of getting on to the disability roll. In the technical terms defined below, we treat the health states—disability and death—as absorbing states, i.e., once in that health state, an individual remains in that health state and removed from the sample for later considerations. An individual can be in normal health and then become disable or die before becoming disabled or may first become diseased with one or more diseases and again from that health state become disabled or die before becoming disabled. Various factors affect individual risks of various transitions of health states and the time they stay in each health state along the life-span. Both, in turn, determine the timing of getting on to the disability rolls.</p>
<p>I model the paths through various health states that individuals follow along their life-spans as a continuous-time finite-state Markov process <span class="math inline">{X(t)},t \in T</span>, where at each time point <span class="math inline">t</span> during the study period <span class="math inline">T</span>, the random variable <span class="math inline">X(t)</span> takes a value from a finite number of health states in <span class="math inline">S</span>. In the present study, we take <span class="math inline">T=\left[0,7\right]</span>, treating age <span class="math inline">51</span> as time period <span class="math inline">t=0</span> and age <span class="math inline">65</span> as time period <span class="math inline">t=7</span>. The unit of time is 2 years, as HRS collected data every two years. The state space <span class="math inline">S</span> contains states, <span class="math inline">1=</span> “healthy or normal health”, <span class="math inline">2=</span> “ill with one or more chronic disease”, <span class="math inline">3=</span> “disabled with DI-or SSI-qualifying disability” and <span class="math inline">4=</span> “Death”. Sometimes I will use <span class="math inline">S=\{h, i, d, D\}</span> in place of <span class="math inline">\{1,2,3,4\}</span>.</p>
<p>Typically in the study period, an individual along the path to disability or death before age 65 may be in the normal health state for a length of time, and then moves to another health state, say diseased health state, and remain there for some time, and then jump to the health state of disability or to death, or reach 65 and censored. There are many possible paths that an individual can follow. Even when the health states they pass through are the same, the duration of stay in each health state (also known as the <em>waiting time</em> in stochastic process literature) could vary. Each configuration of visited states and the waiting times in those states constitute one path. When time is continuous, an uncountably large number of paths are possible. From the diagram below one can see various paths that an individual may follow during the study period. The focus of the paper is to study the probabilities of various transitions and the duration of stay in each health state.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Path diagram of health trajectors.</figcaption><p></p>
<p><img src="Multistate-time2event-cox-LSTM_files/figure-html/fig-fig1-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<p>Let the transition probabilities of our Markov process <span class="math inline">X\left( t\right)</span> be given by <span id="eq-eq1"><span class="math display">
P_{hj}(s,t)=Prob(X(t)=j
X(s)=h),  
\tag{1}</span></span></p>
<p>for all <span class="math inline">h,j\in S</span>, and <span class="math inline">s,t\in T</span>, <span class="math inline">s\leq t</span>. Denote the matrix of transition probabilities by <span class="math display">
P\left( s,t\right) \equiv \left( P_{hj}(s,t)\right) _{h,j=1...p}.
</span></p>
<p>An individual may be in any of the health states in <span class="math inline">S</span> at time <span class="math inline">t</span>, the probability of which, known as the <em>occupation probability</em>, depends on the occupation of the previous health states. and the transition probabilities among health states. Let <span class="math inline">\pi _{j}(t)</span> be the occupation probability of an individual in health state <span class="math inline">j</span> at time <span class="math inline">t</span>. Occupation probability can be also viewed as the proportion of population of age <span class="math inline">t</span> who are in health state <span class="math inline">j</span>. Denote all the occupation probabilities as a column vector <span class="math inline">\pi (t)\equiv (\pi _{j})(t),j\in S</span>. Then the occupation probabilities move over time recursively as follows,</p>
<p><span class="math display">
\pi (t)=\pi ^{\prime }(s)P(s,t),0\leq s&lt;t.
</span></p>
<p>The goal is to estimate for each time time <span class="math inline">s,s\in T</span> the transition probability matrices <span class="math inline">P(s,t),t&gt;s,</span> <span class="math inline">t\in T</span>, taking into account the effects of (i.e., conditioning on) the past materialized values of the determining factors, that is covariates, and the stochastic process <span class="math inline">X(.)</span> up to time <span class="math inline">s</span>.</p>
<p>It is known that the transition probabilities of a Markov process satisfies the Chapman-Kolmogorov equation</p>
<p><span id="eq-eq2"><span class="math display">
P\left( s,t\right) =P\left( s,u\right) \cdot P\left( u,t\right) ,\text{ for
all }s,u,t\in T\text{ with }s&lt;u&lt;t  
\tag{2}</span></span></p>
<p>I will use the above to point out how the transition probabilities are parameterized and statistically estimated by the Aalen-Johnson non-parametric estimation method that plugs in the Nelson-Aalen estimates of the integrates hazards for each transition separately in an unified way for both continuous time and discrete time Markov processes.</p>
<p>I assume that the transition probabilities <span class="math inline">P\left(s,t\right),s,t \in T, s&lt;t</span> are absolutely continuous in <span class="math inline">s</span> and <span class="math inline">t.</span> A <em>transition intensity</em>— also known as the <em>hazard rate</em> in the survival analysis literature when there is only one possible transition (alive to death), and as the <em>cause-specific hazard rate</em> in the competing risk analysis when death is split into various causes of death<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> —of the health process <span class="math inline">X_{t}</span> from health state <span class="math inline">h</span> to health state <span class="math inline">j</span> at time <span class="math inline">t</span> is the derivative</p>
<p><span id="eq-eq3"><span class="math display">
\begin{aligned}
\lambda _{hj}(t) &amp;=\lim_{\Delta t\rightarrow 0}\frac{P_{hj}(t,t+\Delta
t)-P_{hj}\left( t,t\right) }{\Delta t},\text{for }j\in S,\text{ which for }
j\neq h\text{ becomes}  \nonumber \\
&amp;=\lim_{\Delta t\rightarrow 0}\frac{P_{hj}(t,t+\Delta t)}{\Delta t},\text{
and for }j=h\text{ becomes}  \nonumber \\
\lambda _{hh}(t) &amp;=\lim_{\Delta t\rightarrow 0}\frac{P_{hh}(t,t+\Delta t)-1
}{\Delta t}   \\
&amp;=-\lim_{\Delta t\rightarrow 0}\frac{\sum_{j\neq h}P_{hj}(t,t+\Delta t)}{
\Delta t}  \nonumber \\
&amp;=-\sum_{j\neq h}\lambda _{hj}\left( t\right)   \nonumber
\end{aligned}
\tag{3}</span></span></p>
<p>For absorbing states <span class="math inline">h=3,4</span>, the transition intensities <span class="math inline">\lambda _{hj}(t)=0</span> , for all <span class="math inline">j,j\in S</span>. Denote the matrix of transition intensities by</p>
<p><span id="eq-eq4"><span class="math display">
\Gamma \left( t\right) =\left(
\begin{array}{cccc}
-\left( \lambda _{12}\left( t\right) +\lambda _{13}\left( t\right) +\lambda
_{14}\left( t\right) \right)  &amp; \lambda _{12}\left( t\right)  &amp; \lambda
_{13}\left( t\right)  &amp; \lambda _{14}\left( t\right)  \\
0 &amp; -\left( \lambda _{23}\left( t\right) +\lambda _{24}\left( t\right)
\right)  &amp; \lambda _{23}\left( t\right)  &amp; \lambda _{24}\left( t\right)  \\
0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0
\end{array}
\right) .  
\tag{4}</span></span></p>
<p>Every Markov stochastic process has an associated intensity process. In the theory of stochastic processes, it is known that given an intensity function <span class="math inline">\Gamma \left(t\right)</span>, there exists a continuous time Markov chain satisfying the Chapman-Kolmogorov <a href="#eq-eq2">Equation&nbsp;2</a> and conversely, given a Markov chain with transition probabilities <span class="math inline">P\left( s,t\right) ,s,t\in T,s&lt;t</span>, that satisfies the Chapman-Kolmogorov <a href="#eq-eq2">Equation&nbsp;2</a>, one can derive the transition intensities of the form in <a href="#eq-eq4">Equation&nbsp;4</a>. For this reason, the intensity function <span class="math inline">\Gamma \left( t\right)</span> is also referred as <em>infinitesimal generator of the Markov process</em>. While <span class="math inline">P_{hj}(s,t)</span> is an unconditional probability, the transition intensity or the hazard rate <span class="math inline">\lambda _{hj}(t)\Delta t</span> is the conditional (instantaneous) probability. More specifically, <span class="math inline">\lambda _{hj}(t)\Delta t</span> is the probability that an individual experiencing event <span class="math inline">j</span> in a very small interval of time <span class="math inline">[t,t+\Delta t)</span> given that he has been in state <span class="math inline">h</span> at time <span class="math inline">t</span>. This conditional probability may depend on time <span class="math inline">t</span> and other characteristics up to time <span class="math inline">t</span>.</p>
<p>In statistical and neural network models, the dependence of transition probabilities on individual characteristics is generally done through parametric or semi-parametric specification of the transition intensity functions <span class="math inline">\Gamma \left( t\right)</span>. One then estimates the transition probabilities from the non-parametric or semi-parametric estimates of the integrated transition functions. An <em>integrated transition intensity function</em> <span class="math inline">\Lambda _{hj}\left(t\right)</span> for a transition <span class="math inline">h \to j</span> is defined by <span class="math inline">\Lambda _{hj}\left(t\right) =\int_{0}^{t}\lambda _{hj}\left( u\right) du</span>. Just like for a continuous random variable, it is easier to estimate its cumulative density function nonparametrically than its density function, for the time-to-event data with censoring, it is easier to estimate the integrated hazard function than the intensity function. While for the discrete case this problem does not arise, estimation of transition probabilities via nonparametric estimates of the integrated hazard function is an unified approach encompassing both discrete time and continuous time data. I follow this strategy.</p>
<p>To explain and gain insights into this estimation strategy, denote the matrix of all the cumulative hazard functions as <span class="math inline">\Lambda \left(t\right) =\left( \Lambda _{hj}\left(t\right) \right) _{h,j=1,2,3,4}</span>, and the matrix of the derivatives of the component functions by <span class="math inline">d\Lambda \left( t\right)</span>. Let the time interval <span class="math inline">[s,t]</span> is subdivided into a partition of <span class="math inline">m</span> sub-intervals with cut-off points <span class="math inline">s=t_{0}&lt;t_{1}&lt;...&lt;t_{m}=t.</span> Denote the partition by <span class="math inline">P(m).</span> Denote the largest size of the sub-intervals by <span class="math inline">|P(m)|\equiv \max \{|t_{i}-t_{i-1}|,i=1,...,m\}.</span> Applying repeatedly the Chapman-Kolmogorov equation on the sub-intervals of the partition, we have</p>
<p><span id="eq-eq5"><span class="math display">
P(s,t)=P(t_{0},t_{1})\cdot P(t_{1},t_{2})\cdot ...\cdot
P(t_{m-1},t_{m})=\prod_{i=1}^{m}P(t_{i-1},t_{i})  
\tag{5}</span></span></p>
<p>Note that as <span class="math inline">|t_{i-1}-t_{i}|\rightarrow 0,</span> the transition probability matrix <span class="math inline">P(t_{i-1},t_{i})\rightarrow P(t_{i-1},(t_{i-1}+dt)=I+\Gamma (t)dt</span>.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> As <span class="math inline">|P(m)|\rightarrow 0</span>, the right hand side of converges to a matrix, known as the <em>the product integral</em><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> of the integrated hazard functions <span class="math inline">\Lambda (s,t)</span>, denoted as <span class="math inline">\prod_{s}^{t}\left( I+d\Lambda \left( u\right) \right)</span>. Or in other words, the transition probabilities of a stochastic process parameterized via an intensity process is given by the product integral of integrated hazard function.</p>
<p><span id="eq-eq6"><span class="math display">
P\left( s,t\right) =\prod_{s}^{t}\left( I+d\Lambda \left( u\right) \right) .
\tag{6}</span></span></p>
<!-- Change this paragraph and say how the product integral representation is used by Kaplan-Meier to derive product limit estimate of the survival function from censored data.}  -->
<p>The above product-integral solution is a generalization of the Kaplan-Meier (<span class="citation" data-cites="Kaplan.Meier_1958">Kaplan and Meier (<a href="#ref-Kaplan.Meier_1958" role="doc-biblioref">1958</a>)</span>) product-limit formula for the survival function in survival analysis. The product integral formula unifies both discrete time and continuous time Markov processes, and is an extremely useful apparatus for statistical analysis of Markov processes.</p>
<p>The most widely used statistical procedure to estimate the transition probabilities <span class="math inline">P(s,t)</span>, <span class="math inline">s,t\in T,s&lt;t</span> is to plug in an estimate <span class="math inline">\Lambda\left( u\right)</span> in <a href="#eq-eq6">Equation&nbsp;6</a>. The effect of covariates is incorporated by conditioning the transition intensity functions <span class="math inline">\Gamma (t;X(t))</span> on the covariates process <span class="math inline">X(t)</span>. There are many ways to get these estimates. I will follow two approaches in this paper: First, I will explore the more widely used non-parametric Aalen-Johnson-Fleming method via Nelson Aalen estimates for each-component of the <span class="math inline">\hat{\Lambda}\left( u;X\left( u\right) \right)</span> with Cox proportional hazard model to incorporate the time-varying covariate effects in the next sub-section. Second, the Neural network approach explored in a later section.</p>
<section id="aalen-johansen-estimator-of-transition-probabilities" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="aalen-johansen-estimator-of-transition-probabilities"><span class="header-section-number">2.1</span> Aalen-Johansen Estimator of Transition Probabilities</h2>
<p>Most widely used statistical procedure incorporates the time-varying covariates for the transition probabilities by specifying a semi-parametric functional forms for the intensity hazard functions</p>
<p><span id="eq-eq7"><span class="math display">
\lambda _{hj}\left( t;X\left( t\right) \right) =\lambda _{hj}^{0}\left(
t\right) e^{\beta _{hj}^{\prime }X\left( t\right) }  
\tag{7}</span></span></p>
<p><span class="math inline">\lambda _{hj}^{0}\left( t\right)</span> is known as the <em>baseline hazard function</em>. The specification of transition intensity in <a href="#eq-eq7">Equation&nbsp;7</a> is known as the <em>proportional hazard model</em>. It aggregates the effects the regressors linearly as a measure of some kind of latent factor, and that latent factor shifts the baseline hazard proportionately, i.e., the effect on hazard is uniform over time. Two papers — <span class="citation" data-cites="Fleming_1978a">Fleming (<a href="#ref-Fleming_1978a" role="doc-biblioref">1978</a>)</span> and <span class="citation" data-cites="Aalen.Johansen_1978">Aalen and Johansen (<a href="#ref-Aalen.Johansen_1978" role="doc-biblioref">1978</a>)</span> — independently extended the Kaplan-Meier nonparametric product limit estimator from survival analysis to the multi-state time to event models. While <span class="citation" data-cites="Fleming_1978a">Fleming (<a href="#ref-Fleming_1978a" role="doc-biblioref">1978</a>)</span> gave the estimator for complete data, <span class="citation" data-cites="Aalen.Johansen_1978">Aalen and Johansen (<a href="#ref-Aalen.Johansen_1978" role="doc-biblioref">1978</a>)</span> gave the estimator for censored data. To describe the Aalen-Johansen estimator, let me introduce some concepts and notation. For each individual <span class="math inline">i,i=1,2,...,n</span> and corresponding to each transient health state, <span class="math inline">h,h=1,2</span>, define two types of stochastic processes: (1) the counting processes <span class="math inline">N_{hj,i}(t)</span> denoting the <strong><em>observed</em></strong> number of transitions from health state <span class="math inline">h</span> to health state <span class="math inline">j</span> that the individual <span class="math inline">i</span> has made by time <span class="math inline">t</span>—which in our case is either <span class="math inline">0</span> or <span class="math inline">1</span>, since by assumption when an individual exits a health state, the individual does not return to it in future ; and (2) <span class="math inline">Y_{h,i}(t)</span>, taking value <span class="math inline">1</span> if individual <span class="math inline">i</span> is at risk at time <span class="math inline">t</span> for transition to another possible health state, and taking value <span class="math inline">0</span> otherwise.</p>
<p>Let us focus on one transition <span class="math inline">h\rightarrow j</span>. Denote by <span class="math inline">\bar{N} _{hj}(t)=\sum_{i}^{n}N_{hj,i}(t)</span>, a counting process measuring the number of transitions of the <span class="math inline">h\rightarrow j</span> in the sample at time <span class="math inline">t</span>, <span class="math inline">\bar{Y} _{h}(t)=\sum_{i}^{n}Y_{h,i}(t)</span>, a counting process measuring the number of individuals in the sample at risk for a transition at time <span class="math inline">t</span>, and <span class="math inline">\bar{M} _{hj}(t)=\sum_{i}^{n}M_{hj,i}(t)</span>. In any empirical study the data will be at the discrete times, say in ordered times <span class="math inline">0=t_{0}&lt;t_{1}&lt;...&lt;t_{m}</span>. At each time <span class="math inline">t_{i}</span>, we calculate</p>
<p><span id="eq-eq8"><span class="math display">
\hat{\lambda}_{hj}\left( t_{i}\right) =\frac{\triangle \bar{N}_{hj}\left(
t_{i}\right) }{\bar{Y}_{h}\left( t_{i}\right) },j\neq h,  
\tag{8}</span></span></p>
<p>Without covariates, the <em>Nelson-Aalen non-parametric estimate</em> of the integrated intensity functions is given by, for each <span class="math inline">h=1,2</span></p>
<p><span id="eq-eq9"><span class="math display">
\begin{aligned}
\hat{\Lambda}_{hj}\left( t\right)  &amp;=\sum_{i:t_{i}\leq t}\hat{\lambda}
_{hj}\left( t_{i}\right) ,j\neq h,  \nonumber \\
\hat{\Lambda}_{hh}\left( t\right)  &amp;=-\sum \hat{\Lambda}_{hj}\left(
t\right)    \\
\hat{\Lambda}_{hj}\left( t\right)  &amp;=0\text{ for all other }h,j\text{
combinations}  \nonumber
\end{aligned}
\tag{9}</span></span></p>
<p>The <em>Aalen-Johansen estimator</em> <span class="math inline">\hat{P}(s,t),s,t,\in T,s&lt;t</span> for the transition probabilities is obtained by substituting for each component <span class="math inline">hj</span> the Nelson-Aalen estimates <span class="math inline">\hat{\Lambda}_{hj}(t)</span> and then applying the product integral formula <a href="#eq-eq6">Equation&nbsp;6</a> as follows</p>
<p><span id="eq-eq10"><span class="math display">
\hat{P}\left( s,t\right) =\prod\limits_{s&lt;u&lt;t}\left( I+d\hat{\Lambda}\left(
u\right) \right) =\prod\limits_{i:t_{i}\leq t}\left( I+\left[ \hat{\Lambda}
\left( t_{i}\right) -\hat{\Lambda}\left( t_{i-1}\right) \right] \right) .
\tag{10}</span></span></p>
<p>With covariates one obtains the Cox partial likelihood estimate for <span class="math inline">\hat\beta_{hj}</span> for each transition <span class="math inline">h\rightarrow j</span> separately and then computes an weighted risk set defined by</p>
<p><span id="eq-eq11"><span class="math display">
\bar{Y}_{hj}^{\ast }(t)=\sum_{i=1}^{n}Y_{hj,i}\left( t\right) \exp \left(
\hat{\beta}_{hj}^{\prime }X_{h,i}^{0}\right) .  
\tag{11}</span></span></p>
<p>The estimates of cumulative intensities with covariates are obtained from <a href="#eq-eq8">Equation&nbsp;8</a> by replacing, <span class="math inline">\bar{Y}_{h}(t)</span> with <span class="math inline">\bar{Y}_{hj}^{\ast }(t).</span></p>
<p>Nelson-Aalen estimator has nice statistical property. For instance, using Martingale calculus, it can be shown that the estimator is asymptotically unbiased. Using the results from Martingale theory, one can derive the formula for variance-covariance estimates of parameter estimates and the normalized estimate is normally distributed (central limit theorem holds for normalized parameter estimates), see for details, <span class="citation" data-cites="Aalen.etal_2008_Book Andersen.etal_1993_Book Fleming_Harrington_2005_Book">(<a href="#ref-Aalen.etal_2008_Book" role="doc-biblioref">Aalen, Borgan, and Gjessing 2008</a>; <a href="#ref-Andersen.etal_1993_Book" role="doc-biblioref">Andersen et al. 1993</a>; <a href="#ref-Fleming_Harrington_2005_Book" role="doc-biblioref">Fleming and Harrington 2005</a>)</span>.</p>
<p>The likelihood of the sample (for details, see <span class="citation" data-cites="Andersen.etal_1993_Book Andersen.Perme_2008 Commenges_2002">(<a href="#ref-Andersen.etal_1993_Book" role="doc-biblioref">Andersen et al. 1993</a>; <a href="#ref-Andersen.Perme_2008" role="doc-biblioref">Andersen and Perme 2008</a>; <a href="#ref-Commenges_2002" role="doc-biblioref">Commenges 2002</a>)</span>),</p>
<p><span id="eq-eq12"><span class="math display">
\begin{split}
L\left( \theta \right) &amp;=\prod\limits_{i}\prod\limits_{{h=1,2;~}{ {j=2,3,4;~}{h\neq j}}}\left( \prod\limits_{t}\lambda
_{hj,i}\left( t
X_{h,i}\right) ^{\triangle N_{hj,i}\left( t\right) }\right) \\
&amp; \exp \left( -\int_{0}^{T_{h,i}^{\ast }}\lambda _{hj,i}\left(
u
X_{h,i}\right) \right) du  
\end{split}
\tag{12}</span></span></p>
<p>I will use this likelihood function in construction of the log-likelihood loss function for the neural network models. <!-- 
For  continuous time Markov chain @Johansen_1978 and for discrete time Markov
chain @Anderson.Goodman_1957 have shown that the non-parametric Nelson-Aalen estimates are the
maximum likelihood estimates of the above likelihood function. Thus Nelson-Aalen estimates are consistent and efficient. 
--></p>
<p>I use the R package, <em>mstate</em>, developed and described by the authors in <span class="citation" data-cites="Wreede.etal_2010">Wreede, Fiocco, and Putter (<a href="#ref-Wreede.etal_2010" role="doc-biblioref">2010</a>)</span> for the estimation of the parameters and their standard errors?</p>
<p>The Aalen-Johnson nonparametric estimates without any covariates of the transition probabilities, are shown in <a href="#tbl-table3">Table&nbsp;2</a> and plotted in <a href="#fig-fig3">Figure&nbsp;2</a>.</p>
<p>For the Cox regression parameter estimates, I have used both the R package <em>mstate</em> (see, <span class="citation" data-cites="Wreede.etal_2010">Wreede, Fiocco, and Putter (<a href="#ref-Wreede.etal_2010" role="doc-biblioref">2010</a>)</span> for details) and also used the SAS procedure <em>phreg</em> (both produced the same estimates) and used the <em>mstate</em> package to estimate all the transition probabilities (SAS does not have readily available procedure for this purpose). The parameter estimates are shown in <a href="#tbl-table4">Table&nbsp;3</a> and <a href="#tbl-table5">Table&nbsp;4</a>.</p>
</section>
</section>
<section id="sec-sec3" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> The data set and the variables</h1>
<p>I use the Health and Retirement Study (HRS) dataset for empirical analysis. A lot has been reported on the family of HRS datasets—about its structure, purpose, and various modules collecting data on genetics, biomarkers, cognitive functioning, and more, see for instance <span class="citation" data-cites="Juster.Suzman_1995 Sonnega.etal_2014 Fisher.Ryan_2017">(<a href="#ref-Juster.Suzman_1995" role="doc-biblioref">Juster and Suzman 1995</a>; <a href="#ref-Sonnega.etal_2014" role="doc-biblioref">Sonnega et al. 2014</a>; <a href="#ref-Fisher.Ryan_2017" role="doc-biblioref">Fisher and Ryan 2017</a>)</span>. The first survey was conducted in 1992 on a representative sample of individuals living in households i.e., in non-institutionalized, community dwelling, in the United States from the population of cohort born during 1931 to 1941 and their spouses of any age. ``The sample was drawn at the household financial unit level using a multistage, national area-clustered probability sample frame. An oversample of Blacks, Hispanics (primarily Mexican Americans), and Florida residents was drawn to increase the sample size of Blacks and Hispanics as well as those who reside in the state of Florida’’, <span class="citation" data-cites="Fisher.Ryan_2017">Fisher and Ryan (<a href="#ref-Fisher.Ryan_2017" role="doc-biblioref">2017</a>)</span>. The number of respondents were 13,593. Since 1992, the survey were repeated every two years, each is referred to as a wave of survey. New cohorts were added in 1993, 1998, 2004 and 2010, ending the survey up with the sample size of 37,495 from around 23,000 households in wave 12 in 2014. RAND created many variables from the original HRS data for ease of use. I create my dataset and all the variables with a few exceptions mentioned below from the RAND HRS dataset version P. The details of the Rand HRS version P can be found in <span class="citation" data-cites="Bugliari.etal_2016">Bugliari et al. (<a href="#ref-Bugliari.etal_2016" role="doc-biblioref">2016</a>)</span>.</p>
<p>As mentioned in the introduction, I define the disability health state to be one that qualifies one to be on the disability programs OASDI or SSI. The data on disability is self-reported. Later I plan to use the Social Security Administration’s matched administrative data on this variable and earnings variables not included here. The matched data will, however, reduce the sample size to half, as only 50 percent of the respondents are used for matching HRS with SSA Administrative data. The HRS data collected information on if and when the doctor diagnosed that the respondent has any of the severe diseases such as high blood pressure, diabetes, cancer, lung disease, heart attack, stroke, psychiatric disorder and severe arthritis. I drop respondents who received disability before the first survey year 1992 and I also drop the spouses in the sample who were not born between 1931 to 1941, that is the respondents in our sample are between age 51 to 61 and not disabled or dead in 1992. I ended up with the final sample size of 9,493 for this analysis.</p>
<p><a href="#tbl-table1">Table&nbsp;1</a> provides a few characteristics of the data.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-table1" class="anchored">
<table class="table table-sm table-striped">
<caption>Table&nbsp;1: Summary of the health status of the individuals in the sample over the survey years.</caption>
<colgroup>
<col style="width: 11%">
<col style="width: 18%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 21%">
<col style="width: 13%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Survey Year</th>
<th style="text-align: right;">Alive:normal health</th>
<th style="text-align: right;">Alive: diseased</th>
<th style="text-align: right;">Became disabled</th>
<th style="text-align: right;">Died before disability</th>
<th style="text-align: right;">65+: censored</th>
<th style="text-align: right;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1992</td>
<td style="text-align: right;">3026</td>
<td style="text-align: right;">6483</td>
<td style="text-align: right;">92</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9601</td>
</tr>
<tr class="even">
<td style="text-align: right;">1994</td>
<td style="text-align: right;">2591</td>
<td style="text-align: right;">6608</td>
<td style="text-align: right;">166</td>
<td style="text-align: right;">144</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9509</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1996</td>
<td style="text-align: right;">2291</td>
<td style="text-align: right;">6623</td>
<td style="text-align: right;">139</td>
<td style="text-align: right;">146</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9199</td>
</tr>
<tr class="even">
<td style="text-align: right;">1998</td>
<td style="text-align: right;">1726</td>
<td style="text-align: right;">5478</td>
<td style="text-align: right;">134</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">727</td>
<td style="text-align: right;">8188</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2000</td>
<td style="text-align: right;">1279</td>
<td style="text-align: right;">4313</td>
<td style="text-align: right;">86</td>
<td style="text-align: right;">113</td>
<td style="text-align: right;">741</td>
<td style="text-align: right;">6532</td>
</tr>
<tr class="even">
<td style="text-align: right;">2002</td>
<td style="text-align: right;">848</td>
<td style="text-align: right;">3148</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">58</td>
<td style="text-align: right;">759</td>
<td style="text-align: right;">4867</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2004</td>
<td style="text-align: right;">468</td>
<td style="text-align: right;">1893</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">781</td>
<td style="text-align: right;">3224</td>
</tr>
<tr class="even">
<td style="text-align: right;">2006</td>
<td style="text-align: right;">132</td>
<td style="text-align: right;">636</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">795</td>
<td style="text-align: right;">1581</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="variables" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="variables"><span class="header-section-number">3.1</span> Variables</h2>
<p>The demographic variables <strong>White</strong> and <strong>Female</strong> have the standard definition. The variable <strong>College</strong> is a binary variable taking value 1 if the respondent has education level of college and above (does not include some college), i.e., has a college degree and more and taking value 0 otherwise.</p>
<!-- 
**Age:** This is a time varying covariate not perfectly correlated with the duration of occupancy in a health state that the respondent is currently in. No perfect correlation because individuals enter a health state not all at the same age. Thus the transition intensity may have separate effect of age as compared to the duration dependence built in the baseline hazard function. Even at the beginning of the study period, i.e. in 1992, we have individuals begin their initial health states of their health trajectories at different ages (more precisely ages 51 to 61 years).
-->
<p><strong>cesd:</strong> I used a score on the Center for Epidemiologic Studies Depression (CESD) measure in various waves that is created by RAND release of the HRS data. RAND creates the score as the sum of five negative indicators minus two positive indicators. ``The negative indicators measure whether the Respondent experienced the following sentiments all or most of the time: depression, everything is an effort, sleep is restless, felt alone, felt sad, and could not get going. The positive indicators measure whether the Respondent felt happy and enjoyed life, all or most of the time.’’ I standardize this score by subtracting 4 and dividing 8 to the RAND measure. The wave 1 had different set of questions so it was not reported in RAND HRS. I imputed it to be the first non-missing future CESD score. In the paper, I refer the variable as cesd. <span class="citation" data-cites="Steffick_2000">Steffick (<a href="#ref-Steffick_2000" role="doc-biblioref">2000</a>)</span> discusses its validity as a measure of stress and depression.</p>
<!-- 
Conti uses a cut-off point to measure depressive or not depressive and cites the literature on it.
 "Identification of individuals likely suffering from a depressive episode is predicated on the reliability and validity of CES-D cutoff scores. In order to best identify individuals using this score, we relied on an extensive literature on the usefulness of the CES-D in identifying episodes of depression. No equivalent validity and reliability studies for shortened CES-D instruments have been performed in older populations to date. Short forms of the CES-D have been validated for general adult use and shown to be reliable and internally consistent in detecting probable depression (Kohout et al. 1993; Andresen et al. 1994). Several methods have been advanced to convert a cutoff score consistent with probable depression in the full survey (typically 16 out of a total possible score of 60) to the shortened version, each yielding similar results (a score of 2 to 3 out of a possible total score of 8 on the HRS version of the CES-D).7 One recent work has investigated the validity of the full CES-D for recognizing depression in older community-dwelling populations aged fifty-five and older (Lyness et al. 1997). They report that the optimal cutoff score for identifying major depression in an older adult population using the full CES-D to be 20 to 21 out of a possible total score of 60. A score of 20 to 21 on the full CES-D survey is equivalent to a cutoff score of 4 in the shortened version using the proportionality method advanced by Kohout et al. (1993). We implement this cutoff in our sample; the primary measure of depression that we apply to our sample is an aggregate score of 4 or higher on the shortened CES-D in a given year. "
-->
<p><strong>cogtot:</strong> This variable is a measure of cognitive functioning. RAND combined the original HRS scores on cognitive function measure which includes “immediate and delayed word recall, the serial 7s test, counting backwards, naming tasks (e.g., date-naming), and vocabulary questions”. Three of the original HRS cognition summary indices—two indices of scores on 20 and 40 words recall and third is score on the mental status index which is sum of scores “from counting, naming, and vocabulary tasks” — are added together to create this variable. Again due to non-compatibility with the rest of the waves, the score in the first wave was not reported in the RAND HRS. I have imputed it by taking the first future non-missing value of this variable.</p>
<p><strong>bmi:</strong> The variable body-mass-index (BMI) is the standard measure used in the medical field and HRS collected data on this for all individuals. If it is missing in 1992, I impute it with the first future non-missing value for the variable.</p>
<!-- Following the criterion in the literature, I create the variable bmi taking value 1 if BMI> 25 and value 0 otherwise. -->
<p><strong>behav_smoke:</strong> This variable is constructed to be a binary variable taking value 1 if the respondent has reported yes to ever smoked question during any of the waves as reported in the RAND HRS data and then repeated the value for all the years.</p>
<p><strong>behav_vigex:</strong> The RAND HRS has data on whether the respondent did vigorous exercise three or more days per week. I created this variable in each time period to take the value 1 if the respondent did vigorous exercise three or more days per week.</p>
<!-- BLOCK text, not used in the paper

**behav\_prev:** The original HRS surveys starting in 1998 contain responses to a set of questions to capture the respondent's behavior towards preventive care.  I used the dynamic IRT (item response theory) on these responses and used the first dominant factor's loadings for each individual, and define the variable behav\_prev to take value 1 if the factor loading of the variable in a survey year is above the mean of the factor loading score and 0 otherwise.   This makes the measure to be on the same footing for all individuals and time periods.  For the years 1992 and other years with missing values, I imputed it as the first future non-missing value.

**behav\_smoke:** This variable is constructed to be a binary variable taking value 1 if the respondent has reported yes to ever smoked question during any of the waves as reported in the RAND HRS data and then repeated the value for all the years.

**behav\_drink:** This variable created using the dynamic IRT on the categorical variables  in the RAND HRS reporting the number of days per week the respondent drinks. The data is available from wave 3 (i.e., 1996) onward. Using the same methodology as for the behav\_prev described above, I create this binary variable for all the years.

**behav\_vigex:**  The RAND HRS has data on whether the respondent did vigorous exercise three or more days per week.  I created in each time period to be 1 if the respondent did vigorous exercise three or more days per week in any of the waves and then that value is assigned to all the years.
-->
</section>
<section id="statistical-results" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="statistical-results"><span class="header-section-number">3.2</span> Statistical Results</h2>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-table3" class="anchored">
<table class="table table-sm table-striped">
<caption>Table&nbsp;2: Estimated transition probabilities for transitions <span class="math inline">i o j</span> by duration of stay in state 1 and 2.</caption>
<colgroup>
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Duration</th>
<th style="text-align: right;"><span class="math inline">1 \to 1</span></th>
<th style="text-align: right;"><span class="math inline">2 \to 2</span></th>
<th style="text-align: right;"><span class="math inline">1 \to 2</span></th>
<th style="text-align: right;"><span class="math inline">1 \to 3</span></th>
<th style="text-align: right;"><span class="math inline">2 \to 3</span></th>
<th style="text-align: right;"><span class="math inline">1 \to 4</span></th>
<th style="text-align: right;"><span class="math inline">2 \to 4</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.0000</td>
<td style="text-align: right;">1.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.8711</td>
<td style="text-align: right;">1.0000</td>
<td style="text-align: right;">0.1289</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.7543</td>
<td style="text-align: right;">0.9767</td>
<td style="text-align: right;">0.2367</td>
<td style="text-align: right;">0.0062</td>
<td style="text-align: right;">0.0127</td>
<td style="text-align: right;">0.0027</td>
<td style="text-align: right;">0.0106</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.6570</td>
<td style="text-align: right;">0.9430</td>
<td style="text-align: right;">0.3105</td>
<td style="text-align: right;">0.0201</td>
<td style="text-align: right;">0.0292</td>
<td style="text-align: right;">0.0123</td>
<td style="text-align: right;">0.0279</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5786</td>
<td style="text-align: right;">0.9082</td>
<td style="text-align: right;">0.3651</td>
<td style="text-align: right;">0.0331</td>
<td style="text-align: right;">0.0477</td>
<td style="text-align: right;">0.0232</td>
<td style="text-align: right;">0.0441</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.5126</td>
<td style="text-align: right;">0.8730</td>
<td style="text-align: right;">0.4087</td>
<td style="text-align: right;">0.0446</td>
<td style="text-align: right;">0.0659</td>
<td style="text-align: right;">0.0341</td>
<td style="text-align: right;">0.0610</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.4761</td>
<td style="text-align: right;">0.8421</td>
<td style="text-align: right;">0.4212</td>
<td style="text-align: right;">0.0562</td>
<td style="text-align: right;">0.0792</td>
<td style="text-align: right;">0.0465</td>
<td style="text-align: right;">0.0787</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.4667</td>
<td style="text-align: right;">0.8229</td>
<td style="text-align: right;">0.4116</td>
<td style="text-align: right;">0.0681</td>
<td style="text-align: right;">0.0896</td>
<td style="text-align: right;">0.0536</td>
<td style="text-align: right;">0.0874</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p></p><figcaption class="figure-caption">Figure&nbsp;2: Transition probabilities (a) from normal health state, (b) from one-or-more diseased health state</figcaption><p></p>
<p><img src="../Figs/FromR/Fig2.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>With only demographic covariates (most that can be done with the Administrative data) the parameter estimates in <a href="#tbl-table4">Table&nbsp;3</a> show that significantly lower risks of transitions <span class="math inline">1 \to 4</span>; <span class="math inline">2 \to 3</span>; <span class="math inline">2 \to 4</span> for whites and <span class="math inline">1 \to 4</span> and <span class="math inline">2 \to 4</span> for women. This may entail that the genetic make-up of being white or female sex yield favorable genetic predisposition to have better health outcomes and longer life. This is a misleading inference as we will see next that when we control for epigenetic factors that the biomedical literature pointed out to have significant effects on aging process and health outcomes, the above effects disappear.</p>
<p><a href="#tbl-table5">Table&nbsp;4</a> shows the Cox regression coefficient estimates of the effects of various factors on the risk of having transitions <span class="math inline">h\rightarrow j</span> from health status <span class="math inline">h = 1,2</span> to health status <span class="math inline">j, j=2,3,4</span>.</p>
<p>These estimates show that the parameter estimates for the demographic covariates in <a href="#tbl-table4">Table&nbsp;3</a> are biased as they are capturing the effects of excluded epigenetic and behavioral factors in that model. After controlling for these epigenetic and behavioral factors, the significance of those effects disappear. Furthermore, women show significantly lower probability of transition from diseased health states onto the disability health state.</p>
<p>Most important factors in <a href="#tbl-table5">Table&nbsp;4</a> are cesd, measuring depression and stress and college graduation or higher level of education, with positive effect on all transitions with the exception of no effect on transition from normal health to death.</p>
<p>Other important factors are smoking, with significant adverse effect on transitions, and exercising three or more times regularly has significant favorable effect on most transitions.</p>
<div class="cell" data-warnings="false">
<div class="cell-output-display">
<div id="tbl-table4" class="anchored">

<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 100%; margin-left: auto; margin-right: auto;  " id="tab:table4">
<caption style="caption-side: top; text-align: center;">Table&nbsp;3:  Estimates of Cox regression models separately for each transition with demographic variables only </caption><colgroup><col style="width: 28.5714285714286%"><col style="width: 14.2857142857143%"><col style="width: 14.2857142857143%"><col style="width: 14.2857142857143%"><col style="width: 14.2857142857143%"><col style="width: 14.2857142857143%"></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 3pt 0pt 2pt 0pt; border-top-color: rgb(0, 0, 0);   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: bold;"></th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 3pt 0pt 2pt 0pt; border-top-color: rgb(0, 0, 0);   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: bold;">1-&gt;2</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 3pt 0pt 2pt 0pt; border-top-color: rgb(0, 0, 0);   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: bold;">1-&gt;3</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 3pt 0pt 2pt 0pt; border-top-color: rgb(0, 0, 0);   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: bold;">1-&gt;4</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 3pt 0pt 2pt 0pt; border-top-color: rgb(0, 0, 0);   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: bold;">2-&gt;3</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 3pt 0pt 2pt 0pt; border-top-color: rgb(0, 0, 0);   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: bold;">2-&gt;4</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 2pt 0pt 0pt 0pt; border-top-color: rgb(0, 0, 0);    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: bold;">White</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 2pt 0pt 0pt 0pt; border-top-color: rgb(0, 0, 0);    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">-0.028</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 2pt 0pt 0pt 0pt; border-top-color: rgb(0, 0, 0);    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">-0.328</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 2pt 0pt 0pt 0pt; border-top-color: rgb(0, 0, 0);    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">-0.716 **</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 2pt 0pt 0pt 0pt; border-top-color: rgb(0, 0, 0);    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">-0.387 ***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 2pt 0pt 0pt 0pt; border-top-color: rgb(0, 0, 0);    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">-0.426 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.067)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.230)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.265)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.102)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.102)</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: bold;">Female</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">0.052</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-0.216</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-0.522 *</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-0.029</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-0.493 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.050)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.190)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.251)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.092)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.093)</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: bold;">#obs</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">3583</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">3695</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">3652</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">6856</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">6855</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: bold;">#events</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">1602&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">112&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">69&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">476&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">475&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: bold;">R squared</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">0.000</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">0.001</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">0.003</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">0.002</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">0.006</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: bold;">logLik</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-12671.44&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-854.58&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-518.80&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-4038.09&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-3994.91&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 2pt 0pt;   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: bold;">AIC</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 2pt 0pt;   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: normal;">25346.88&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 2pt 0pt;   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: normal;">1713.15&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 2pt 0pt;   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: normal;">1041.60&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 2pt 0pt;   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: normal;">8080.17&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 2pt 0pt;   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: normal;">7993.81&nbsp;</td></tr>
<tr>
<th colspan="6" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 2pt 0pt 0pt 0pt; border-top-color: rgb(0, 0, 0);    padding: 0pt 2pt 0pt 2pt; font-weight: bold;"> *** p &lt; 0.001;  ** p &lt; 0.01;  * p &lt; 0.05.</th></tr>
</tbody></table>

</div>
</div>
</div>
<div class="cell" data-warnings="false">
<div class="cell-output-display">
<div id="tbl-table5" class="anchored">

<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 100%; margin-left: auto; margin-right: auto;  " id="tab:table5">
<caption style="caption-side: top; text-align: center;">Table&nbsp;4:  Estimates of Cox regression models separately for each transition with health measures </caption><colgroup><col style="width: 28.5714285714286%"><col style="width: 14.2857142857143%"><col style="width: 14.2857142857143%"><col style="width: 14.2857142857143%"><col style="width: 14.2857142857143%"><col style="width: 14.2857142857143%"></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 3pt 0pt 2pt 0pt; border-top-color: rgb(0, 0, 0);   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: bold;"></th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 3pt 0pt 2pt 0pt; border-top-color: rgb(0, 0, 0);   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: bold;">1-&gt;2</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 3pt 0pt 2pt 0pt; border-top-color: rgb(0, 0, 0);   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: bold;">1-&gt;3</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 3pt 0pt 2pt 0pt; border-top-color: rgb(0, 0, 0);   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: bold;">1-&gt;4</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 3pt 0pt 2pt 0pt; border-top-color: rgb(0, 0, 0);   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: bold;">2-&gt;3</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 3pt 0pt 2pt 0pt; border-top-color: rgb(0, 0, 0);   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: bold;">2-&gt;4</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 2pt 0pt 0pt 0pt; border-top-color: rgb(0, 0, 0);    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: bold;">cesd</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 2pt 0pt 0pt 0pt; border-top-color: rgb(0, 0, 0);    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">0.561 ***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 2pt 0pt 0pt 0pt; border-top-color: rgb(0, 0, 0);    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">1.980 ***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 2pt 0pt 0pt 0pt; border-top-color: rgb(0, 0, 0);    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">0.126</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 2pt 0pt 0pt 0pt; border-top-color: rgb(0, 0, 0);    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">1.295 ***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 2pt 0pt 0pt 0pt; border-top-color: rgb(0, 0, 0);    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">0.547 *</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.120)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.352)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(1.109)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.155)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.256)</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: bold;">bmi</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">0.042 ***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-0.005</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">0.012</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">0.025 **</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-0.021</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.006)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.025)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.050)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.008)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.014)</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: bold;">cogtot</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">-0.003</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">-0.067 **</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">0.015</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">-0.035 ***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">-0.009</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.006)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.022)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.048)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.010)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.015)</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: bold;">behav_smoke</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">0.045</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">0.258</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">2.511 *</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">0.381 ***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">0.817 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.054)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.226)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(1.028)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.108)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.180)</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: bold;">behav_vigex </th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">-0.197 **</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">-1.000 ***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">-1.169 *</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">-0.610 ***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">-1.199 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.075)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.235)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.485)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.102)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.145)</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: bold;">White</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">0.045</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">0.098</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-0.494</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-0.117</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-0.325 *</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.072)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.269)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.498)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.112)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.165)</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: bold;">College</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">-0.111</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">-0.887 *</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">-1.114</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">-0.684 ***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">-0.744 **</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.069)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.406)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.760)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.195)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 4pt 2pt; background-color: rgb(229, 241, 240); font-weight: normal;">(0.262)</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: bold;">Female</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">0.085</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-0.273</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-0.686</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-0.080</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-0.252</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.055)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.221)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.470)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.101)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">(0.146)</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: bold;">#obs</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">3239</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">3334</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">3262</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">6165</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">5926</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: bold;">#events</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">1500&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">95&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">23&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">446&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">207&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: bold;">R squared</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">0.029</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">0.025</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">0.008</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">0.037</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">0.022</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: bold;">logLik</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-11647.65&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-671.06&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-151.05&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-3626.20&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 2pt 0pt 2pt; font-weight: normal;">-1626.01&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 2pt 0pt;   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: bold;">AIC</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 2pt 0pt;   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: normal;">23311.31&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 2pt 0pt;   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: normal;">1358.12&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 2pt 0pt;   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: normal;">318.10&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 2pt 0pt;   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: normal;">7268.41&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 2pt 0pt;   border-bottom-color: rgb(0, 0, 0);  padding: 0pt 2pt 0pt 2pt; font-weight: normal;">3268.01&nbsp;</td></tr>
<tr>
<th colspan="6" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 2pt 0pt 0pt 0pt; border-top-color: rgb(0, 0, 0);    padding: 0pt 2pt 0pt 2pt; font-weight: bold;"> *** p &lt; 0.001;  ** p &lt; 0.01;  * p &lt; 0.05.</th></tr>
</tbody></table>

</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="sec-sec4" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Long-short memory (LSTM) recurrent neural network (RNN) model of health outcomes process</h1>
<p>I first give an overview of the neural network framework. I then briefly review a selected few papers that used the neural network framework to estimate and predict the time-to-event probabilities in a single event set-up. The main focus of the papers, including this paper, is to relax the proportionality and linearity assumption of the statistical survival models, see <a href="#eq-eq7">Equation&nbsp;7</a> for the proportionality assumption. I then explain why a long-short memory (LSTM) recurrent neural network (RNN) framework is more appropriate for predictive models of time-to-event probabilities in sequential set-up. I describe the <em>c-index</em> criterion that I use to compare the performance of various models and compare the performance of the multistate statistical model and a feed-forward neural network model of competing risk model by <span class="citation" data-cites="Lee.etal_2018">Lee et al. (<a href="#ref-Lee.etal_2018" role="doc-biblioref">2018</a>)</span> with the LSTM-RNN model of this paper. I code these three models using Keras and Tensorflow 2.0 modules in Python and estimate them using the Health and Retirement Survey data mentioned above. In the following section, I report the findings.</p>
<section id="sec-sec4N" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="sec-sec4N"><span class="header-section-number">4.1</span> The basics of neural network</h2>
<p>I first give an overview of the neural network framework. I then briefly review a selected few papers that used the neural network framework to estimate and predict the time-to-event probabilities in a single event set-up. The main focus of the papers, including this paper, is to relax the proportionality and linearity assumption of the statistical survival models, see <a href="#eq-eq7">Equation&nbsp;7</a> for the proportionality assumption. I then explain why a long-short memory (LSTM) recurrent neural network (RNN) framework is more appropriate for predictive models of time-to-event probabilities in sequential set-up. I describe the <em>c-index</em> criterion that I use to compare the performance of various models and compare the performance of the multistate statistical model and a feed-forward neural network model of competing risk model by <span class="citation" data-cites="Lee.etal_2018">Lee et al. (<a href="#ref-Lee.etal_2018" role="doc-biblioref">2018</a>)</span> with the LSTM-RNN model of this paper. I code these three models using Keras and Tensorflow 2.0 modules in Python and estimate them using the Health and Retirement Survey data mentioned above. In the following section, I report the findings.</p>
<p>Neural network is a highly parameterized universal function approximator of the form <span class="math inline">\hat y = f(x;w)</span>, <span class="math inline">x</span> is a set of inputs, and <span class="math inline">w</span> is a vector of parameters. This is of the same nature as a statistical model. More precisely, suppose we have data on a set of individuals of the type <span class="math inline">(x,y)</span>, where x is a vector of individual characteristics, and y is a vector of output levels and <span class="math inline">w</span> is a set of parameters. The output could be a categorical variable for classification problems, it could be a probability distribution over finite classes, as in our case, or it could be a continuous variable for regression problems. The data generating process for <span class="math inline">y</span> as a function of x, is not known. The goal is to approximate that unknown data generating function. This is the problem that both statistics and neural network find computational solutions to. In neural network, the problem is to design a <em>neural network architecture</em> of the approximating function <span class="math inline">\hat y = f(x,w)</span> and find a suitable <em>learning algorithm</em> to learn the parameter values <span class="math inline">w</span> of the network using a training set of examples. This trained network can then be used to predict <span class="math inline">y</span> for an individual given his characteristics <span class="math inline">x</span>.</p>
<p>The popularity and wide applicability of neural network lies in the fact that it designs the approximator in a hierarchy of functions, joined together by compositions of functions, that renders good properties in terms of ease of computation and closeness of function approximation. Most neural network models have the following type of hierarchical functional form:</p>
<p><span id="eq-eqN1"><span class="math display">
\hat y = f(x;w) \equiv f^L_{w^L} \circ ....\circ f^1_{w_1} (x).
\tag{13}</span></span></p>
<p>Each function corresponds to a layer of artificial neurons. The role of each neuron is to perform simple calculations and then pass on that to the next layer of neurons.</p>
<p>Neurons in each layer get signals which are the outputs of the neurons of the previous layer (also known as activation levels) that it is connected with. It sums them, I denote this sum with <span class="math inline">z</span> &nbsp;and apply an activation function to produce an output also known as <em>activation level</em> which I denote by <span class="math inline">a</span>. The activation level <span class="math inline">a</span> will then be passed on as an input to a neuron that it is connected to in the next layer. The neurons of the last layer will compute the output level taking the activation levels of the connected neurons of the previous layer.</p>
<p>Consider a simple neural network architecture depicted in <a href="#fig-figN1">Figure&nbsp;3</a>. It has three layers — layer 0: input layer, layer 1: hidden layer, and layer 2: output layer. Last layer in the text is denoted by <span class="math inline">L</span>, and hence <span class="math inline">L=2</span>. Layer <span class="math inline">0</span> has three input neurons. The second layer has 4 neurons. and last layer has two neurons corresponding to the two output levels, in our case probability of two events. In this neural network, the hierarchical function specification is of the form:</p>
<p><span id="eq-eqN2"><span class="math display">
f(x;w)=\sigma ^{2}\left( z^{2}\left( \sigma ^{1}\left( z^{1}(x,w^{1})\right)
,w^{2}  \right) \right) \equiv f_{w^{2}}^{2}\circ f_{w^{1}}^{1}(x).
\tag{14}</span></span></p>
<p>The function <span class="math inline">z^{i}(a^{i},w^{i})=w^{i}\cdot a^{i-1}</span> at each layer <span class="math inline">i</span> is a linear aggregator. In the notation, <span class="math inline">z^{i}</span> is a vector of functions, each component of which corresponds to a neuron of the ith layer. The function <span class="math inline">\sigma ^i</span> is a squashing function of the same dimension as <span class="math inline">z^i</span>, each component having the same function real valued function of one variable, known as <em>activation function</em>, which squashes the value of <span class="math inline">z^i</span> to a range such as <span class="math inline">(0,1)</span> for a sigmoid activation function, or <span class="math inline">(-1, 1)</span> for the <span class="math inline">tanh</span> activation function. The value of the activation function, <span class="math inline">a^i =\sigma^i(z^i)</span> is known as the <em>activation level</em> of the neurons of the ith layer. The activation levels of the 0th layer, <span class="math inline">a^{0} = x</span>, the inputs, fed to the neural network from outside. The operation on the right is also performed component-wise for each neuron at the ith layer it computes the weighted sum of the activation levels (outputs) of the neurons of the previous layer that the neuron of the ith layer is connected to. The weights used are specific to the neuron of the ith layer. An activation function <span class="math inline">\sigma ^{i}</span> which generally taken to be same for all the neurons of the ith layer) is applied to this aggregated value <span class="math inline">z^{i}</span>. These activation functions do not have any unknown parameters that need to be estimated. These two computations—aggregation and activation—are shown as a composite mapping <span class="math inline">f_{w^{i}}^{i}</span> for the neurons of the ith layer.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-figN1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p></p><figcaption class="figure-caption">Figure&nbsp;3: MLP architechture.</figcaption><p></p>
<p><img src="Multistate-time2event-cox-LSTM_files/figure-html/fig-figN1-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>There are different types of neural network, depending on the functional form of <span class="math inline">f</span> in <a href="#eq-eqN1">Equation&nbsp;13</a>. A <em>deep feed forward neural network</em>, also known as a <em>feedforward neural network with hidden layers</em> or as a <em>multilayer perceptron (MLP)</em> is a network architecture in which there is no feedback of any neurons to itself or to others in the same layer. The activation levels of the neurons only feed forward to the neurons in the next layer. This is the reason also why these type of neural networks are called feed forward, as opposed to the recurrent neural network consider later that allow feedback. The MLP has good computational properties and an MLP is a great universal functional approximator: It is shown <span class="citation" data-cites="Hornik.etal_1989">Hornik, Stinchcombe, and White (<a href="#ref-Hornik.etal_1989" role="doc-biblioref">1989</a>)</span> that with a sufficient number of layers in a hidden layer can approximate a function to any level of precision desired. So a MLP can be used to approximate the true data generating process as closely as one wants. How does one find such a network, i.e., how does one choose the weights of the network.</p>
<p>To get a good approximation, the artificial neural network contains hundreds of thousands of deep parameters <span class="math inline">w</span>, how does one train the network, i.e., how to learn the the parameter values. The learning is done by choosing the weights to minimize a loss function together with a nonnegative regularization term (in statistical term a regulerization term corresponds to shrinkage estimator).</p>
<p><span id="eq-eqN3"><span class="math display">
L (y, f(x,w))  + \lambda C(w).
\tag{15}</span></span></p>
<p>In the present context of learning about a probability distribution of time-to-events, an appropriate loss function is to take the negative log-likelihood of the sample and the additive regularization term <span class="math inline">C(w)</span> to be <span class="math inline">||w||_2</span>. In this case the loss function with regularization term has a Bayesian interpretation—it is the posterior log-likelihood with normal prior distribution for the parameters <span class="math inline">w</span>. The choice of <span class="math inline">w</span> to minimize the loss is done by a gradient descent method. The neural network architecture <a href="#eq-eqN1">Equation&nbsp;13</a> yields a very convenient fast and automatic computation of the gradients <span class="math inline">\partial L / \partial w</span> using an algorithm known as back-propagation algorithm, used pretty much in all types of neural networks. Two steps in this algorithm are assume an initial value of the weights <span class="math inline">w</span>, first compute all the activation levels starting at the input layer, i.e., <span class="math inline">f^1_w(x)</span> forward through the layers <span class="math inline">2,3, ..., L</span> in <a href="#eq-eqN1">Equation&nbsp;13</a>, i.e., go through layer superscripts forward. In the next step, compute the gradients of the weight parameters <span class="math inline">w</span> of various layers, starting from the last layer, backward in layers, i.e., decreasing order in the subscripts in <a href="#eq-eqN1">Equation&nbsp;13</a>. Once all gradients are computed, weights are adjusted using a steepest descent algorithm. Further details are omitted, since I do not implement any type of back propagation algorithm in this paper.</p>
</section>
<section id="previous-neural-network-models-of-survival-analysis" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="previous-neural-network-models-of-survival-analysis"><span class="header-section-number">4.2</span> Previous neural network models of survival analysis</h2>
<p>The main objective of the neural network approach to survival analysis is the relaxation of restrictive proportional hazard assumption in <a href="#eq-eq7">Equation&nbsp;7</a>. The following papers use a MLP architecture to estimate the survival probabilities with covariates fixed at the beginning of the study period. <span class="citation" data-cites="Faraggi.Simon_1995 Biganzoli.etal_1998 Fernandez.etal_2016 Katzman.etal_2018 Lee.etal_2018 Ranganath.etal_2016 Ren.etal_2019 Zhao.etal_2019">(<a href="#ref-Faraggi.Simon_1995" role="doc-biblioref">Faraggi and Simon 1995</a>; <a href="#ref-Biganzoli.etal_1998" role="doc-biblioref">Biganzoli et al. 1998</a>; <a href="#ref-Fernandez.etal_2016" role="doc-biblioref">Fernandez, Rivera, and Teh 2016</a>; <a href="#ref-Katzman.etal_2018" role="doc-biblioref">Katzman et al. 2018</a>; <a href="#ref-Lee.etal_2018" role="doc-biblioref">Lee et al. 2018</a>; <a href="#ref-Ranganath.etal_2016" role="doc-biblioref">Ranganath et al. 2016</a>; <a href="#ref-Ren.etal_2019" role="doc-biblioref">Ren et al. 2019</a>; <a href="#ref-Zhao.etal_2019" role="doc-biblioref">Zhao et al. 2019</a>)</span>. Except for <span class="citation" data-cites="Lee.etal_2018">Lee et al. (<a href="#ref-Lee.etal_2018" role="doc-biblioref">2018</a>)</span> who consider a competing risk model, all other papers consider two-state, alive-death, models.</p>
<p>Two main limitations of the previous literature is that they use feed-forward neural network architecture to specify the functional approximator for the hazard function in <a href="#eq-eq7">Equation&nbsp;7</a>. These are static model in the sense that the input vectors of an individual are given at the begin of the period and the neural network model predict the probabilities of the event for a fixed number of periods. This is problematic because prediction of probabilities at a given period use all the information from the future periods. It cannot handle training using data in which some individuals do not have information for all periods. More importantly, these models cannot incorporate new information that may come after training the model to update the time-to-event prediction probabilities. Another shortcoming of these models is that they are restricted to analyzing life histories of only one transition between two health states—from alive to death or at the most to various causes of death in the language of survival analysis. As I have mentioned in the introduction, to better predict the probabilities of time to certain health come of interest, it is important to analyze dynamic paths through other intermediary health outcomes and the factors that affect the dynamics of those paths. I argue that a long-short memory recurrent neural network is more appropriate model to that end. I explain this framework next.</p>
</section>
<section id="formulation-within-recurrent-neural-network-with-lstm" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="formulation-within-recurrent-neural-network-with-lstm"><span class="header-section-number">4.3</span> Formulation within Recurrent Neural Network with LSTM</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-figN2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p></p><figcaption class="figure-caption">Figure&nbsp;4: Showing a simple recurrent neural, with layer <span class="math inline">0</span> is the input layer, layer <span class="math inline">1</span> is the recurrent hidden layer, layer <span class="math inline">2</span> is another pure hidden layer, layer <span class="math inline">3</span> is the output layer, for each time point <span class="math inline">(t)</span>, layers are denoted as superscipt, and the subscript in parenthesis is time.</figcaption><p></p>
<p><img src="Multistate-time2event-cox-LSTM_files/figure-html/fig-figN2-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Let <span class="math inline">x_t</span> be a set of measurements, or characteristics and <span class="math inline">y_t</span>, a set of health outcomes are measured repeatedly over time <span class="math inline">t, t = 0, 1, ...T</span>. A recurrent neural network (RNN) allows a feedback link among neurons in a hidden layer. A typical RNN is shown in the left panel and the unfolded version in the right panel of <a href="#fig-figN2">Figure&nbsp;4</a>. This neural network is a simple three layer architecture similar to MLP architecture shown earlier, with one main difference is that the hidden layer has a feedback connection linked to itself, i.e., a cyclical or recurrent connection and there is weight sharing, i.e., the weights of all the layers for a given time period <span class="math inline">t</span> is constant for all time periods. The recurrent connections in the RNN architecture effectively creates an internal memory of the effects of previous inputs that can affect the current and future outcomes. It is also interesting to note that the functional forms of the RNN are similar to Kalman filtering models, but more general in some respects and restrictive in some other respects.</p>
<p>The hidden layer 1: The activation levels of the hidden recurrent layer at time-step <span class="math inline">t</span> is produced by combining activation levels <span class="math inline">h_{t-1}</span> of the previous period’s hidden recurrent layer and input levels <span class="math inline">x_{t}</span> and then applying the activation function <span class="math inline">\sigma ^{1}</span> as follows: For <span class="math inline">t=0,1,2,...T</span> Layer 1 (hidden recurrent layer):</p>
<p><span class="math display">
\begin{aligned}
h_t &amp;=\sigma ^{1}(W^{1}\cdot x_t+U\cdot h_{t-1}+b^{1})  \nonumber \\
a_t^{1} &amp;\equiv h_t
\text{ (for notational convenience)} \\
h_{-1} &amp;=\text{ a user supplied initial activation level}  \nonumber
\end{aligned}
</span></p>
<p>Layer 2 (Output): <span class="math display">
\begin{aligned}
a_t^{2} &amp;=\sigma ^{2}(W^{2}\cdot a_t^{1}+b^{\ell })  \nonumber \\
\hat{y}_{t} &amp;\equiv a_t^{2}\text{ (notational convenience) }
\end{aligned}
</span></p>
<p>The pseudo computational graph of the network is shown in <a href="#fig-figN2">Figure&nbsp;4</a>.</p>
<p>It may seem a minor difference between the architectures of an MLP and an RNN, but difference in their capabilities are very important and crucial for sequential learning. For instance, an RNN can map the entire history of previous inputs to each output as compared to an MLP which can map only current input to output vectors. Similar to the result that an MLP is an universal function approximator mentioned earlier, with a sufficiently large number of hidden self-connected neurons, an RNN can approximate extremely closely any sequence-to-sequence mapping, see <span class="citation" data-cites="Graves.etal_2014 Hammer_2000 Siegelmann.Sontag_1992">(<a href="#ref-Graves.etal_2014" role="doc-biblioref">Graves, Wayne, and Danihelka 2014</a>; <a href="#ref-Hammer_2000" role="doc-biblioref">Hammer 2000</a>; <a href="#ref-Siegelmann.Sontag_1992" role="doc-biblioref">Siegelmann and Sontag 1992</a>)</span>. There are various types of RNN, for details see <span class="citation" data-cites="Graves_2012_Book Lipton.etal_2015a">(<a href="#ref-Graves_2012_Book" role="doc-biblioref">Graves 2012</a>; <a href="#ref-Lipton.etal_2015a" role="doc-biblioref">Lipton, Berkowitz, and Elkan 2015</a>)</span>. In many situations, especially in drug-discovery, the study samples may have small size, an important extension of an RNN framework that handles this problem is <span class="citation" data-cites="Altae-Tran_2016 Altae-Tran.etal_2017">(<a href="#ref-Altae-Tran_2016" role="doc-biblioref">Altae-Tran 2016</a>; <a href="#ref-Altae-Tran.etal_2017" role="doc-biblioref">Altae-Tran et al. 2017</a>)</span>.</p>
<p>The computation of the gradients is done using a modification of the back propagation method known as back propagation through time, which involves multiplication of gradients less than one many times over the time steps tending to vanishing gradient problem, meaning the gradient of the weights representing memories of the far back in time tend to zero or vanish. A similar problem arises when the gradients larger than 1 are multiplied many times leading to exploding gradient problem.</p>
<p>Quite a few other fixes are proposed for the vanishing and exploding gradient problems of RNN models, such clipping of gradients, and various other types of extensions such as <span class="citation" data-cites="Elman_1990">Elman (<a href="#ref-Elman_1990" role="doc-biblioref">1990</a>)</span> are proposed. But the long-short memory extension of the RNN framework by <span class="citation" data-cites="Hochreiter.Schmidhuber_1997">Hochreiter and Schmidhuber (<a href="#ref-Hochreiter.Schmidhuber_1997" role="doc-biblioref">1997</a>)</span> proved to be very useful and successful in many applications which I use for this paper.</p>
</section>
<section id="lstm-memory-cell" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="lstm-memory-cell"><span class="header-section-number">4.4</span> LSTM memory cell</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-figN3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p></p><figcaption class="figure-caption">Figure&nbsp;5: Showing a typical memory cell at time-step <span class="math inline">t</span></figcaption><p></p>
<p><img src="Multistate-time2event-cox-LSTM_files/figure-html/fig-figN3-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The main innovation in this approach is to replace the hidden recurrent cells in an RNN with a memory cell with three gates—an input gate, an output gate and a forget gate—and a recurrent cell memory together with the original hidden layer memory cell. The functional form of a typical LSTM memory cell is as follows</p>
<p>Layer 1 (Hidden layer with recurrent neurons): <span class="math display">
\begin{aligned}
f_{t}&amp;= \sigma \left( W^{f}\cdot x_{t}+U^{f}\cdot h_{t-1}+b^{f}\right)  
\nonumber \\
i_{t}&amp;= \sigma \left( W^{i}\cdot x_{t}+U^{i}\cdot h_{t-1}+b^{i}\right)  
\nonumber \\
o_{t}&amp;= \sigma \left( W^{o}\cdot x_{t}+U^{o}\cdot h_{t-1}+b^{o}\right)  
\nonumber \\
\bar{c}_{t}&amp;=  tanh(W^{c}\cdot x_{t}+U^{c}\cdot h_{t-1}+b^{c}) \\
c_{t}&amp;= f_{t}\ast c_{t-1}+i_{t}\ast \bar{c}_{t}  \nonumber \\
h_{t}&amp;= o_{t}\ast tanh(c_{t})  \nonumber \\
a_{t}^{1}&amp;\equiv  h_{t}\newline
\text{ (for notational convenience)}  \nonumber\\
h_{-1}, c_{-1} &amp;= \text{  user supplied initial activation levels}  \nonumber
\end{aligned}
</span></p>
<p>Layer 2 (Output): This is same as the RNN output layer. <span class="math display">
\begin{aligned}
a_{t}^{2} &amp;=\sigma ^{2}(W^{2}\cdot a_{t}^{1}+b^{1 })  \nonumber \\
\hat{y}_{t} &amp;\equiv a_{t}^{2}\text{ (notational convenience) }
\end{aligned}
</span> The pseudo computational graph of the network is shown in <a href="#fig-figN3">Figure&nbsp;5</a>.</p>
</section>
</section>
<section id="sec-sec5" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Prediction and performance of the model</h1>
<p>As a multistate time to event model has censored data, the standard metrics such as <span class="math inline">R^2</span>, root mean square error are not applicable for performance measurement. <span class="citation" data-cites="Harrell.etal_1982">Harrell et al. (<a href="#ref-Harrell.etal_1982" role="doc-biblioref">1982</a>)</span> introduce the measure of concordance index, known as c-index, extending the concept of the area under the ROC curve, which was further refined by <span class="citation" data-cites="Antolini.etal_2005">Antolini, Boracchi, and Biganzoli (<a href="#ref-Antolini.etal_2005" role="doc-biblioref">2005</a>)</span> to be applicable for survival models with time-varying covariates. Most machine learning models use this criteion to compare the performance of various neural network models of survival analysis.</p>
<p>To get the basic idea behind the c-index, suppose two individual in the dataset are in a particular health state, both of whom are at risk for exits to another possible health state. Suppose the first individual exits at time <span class="math inline">t</span> and the second individual did not exit at time <span class="math inline">t</span> or earlier. The first individual’s estimated survival probability at time <span class="math inline">t</span> should be smaller than the second individual who did not exit. A good model should have this maintained for most or all such comparable pairs. The c-index measures the proportion people for whom this is true out of all the people who could be compared.</p>
<p>I use the c-index criterion to discriminate the performance of various models in predicting time-to-event probabilities. The c-index estimates for three three models are shown in the last row of <a href="#tbl-table6">Table&nbsp;5</a>. Judging from the c-index estimates, it appears that neural network models do better job in prediction of time to event probabilities than Aalen-Johansen estimators of the multistate statistical model. Furthermore, the LSTM-RNN model of this paper does perform slightly better.</p>
<div class="cell" data-warnings="false">
<div class="cell-output-display">
<div id="tbl-table6" class="anchored">

<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 80%; margin-left: auto; margin-right: auto;  " id="tab:tbl-table6">
<caption style="caption-side: top; text-align: center;">Table&nbsp;5:  Average of the Predicted cumulative incidence rates of disability and death for three methods for the test sample. </caption><colgroup><col><col><col><col><col><col><col></colgroup><tbody><tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: bold;"></td><td colspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: bold;">Statistical multistate  model</td><td colspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: bold;">Lee etal Deephit model</td><td colspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: bold;">LSTM-RNN model</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: bold;">T</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: bold;">Disability</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: bold;">Death</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: bold;">Disability</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: bold;">Death</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: bold;">Disability</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: bold;">Death</th></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.000</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.000</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.000</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.000</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.000</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.001</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.000</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.000</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.027</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.000</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.035</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.000</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.017</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.017</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">2.000</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.064</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.000</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.052</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.004</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.032</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.045</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">3.000</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.109</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.035</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.120</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.026</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.044</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.080</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">4.000</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.152</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.088</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.247</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.050</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.055</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.122</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">5.000</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.179</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.141</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.271</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.133</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.063</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.167</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">6.000</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.199</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.166</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.287</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.155</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.070</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.208</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">7.000</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.206</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.197</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.496</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.504</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.077</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.248</td></tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">c-index</td><td colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.476</td><td colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.748</td><td colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.756</td></tr>
</tbody></table>

</div>
</div>
</div>
<p>I also show in <a href="#tbl-table6">Table&nbsp;5</a> the average of the predicted time to event probabilities of the individuals in the test data set, and in <a href="#fig-fig4">Figure&nbsp;6</a>, I plotted the average probabilities together with the confidence intervals. Looking at the variability in the graph, and direct comparison of probabilities for the individual cases, it appears that neural network models might be over-fitting the data, in spite of using the <span class="math inline">L_2</span> regularization. More investigation is needed.</p>
<p>So I based my comparison of the models using the c-index.</p>
<div id="fig-fig4" class="cell quarto-layout-panel">
<p></p><figcaption>Figure&nbsp;6: Means and mean <span class="math inline">\pm</span> standard deviation intervals of the predicted cumulative incidence rates of disability and death in the test sample</figcaption><p></p>
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-fig4-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p></p><figcaption class="figure-caption">(a) Aalan-Johansen model</figcaption><p></p>
<p><img src="../Figs/FromPy/AalenJohansen.png" class="img-fluid figure-img" data-ref-parent="fig-fig4"></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-fig4-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p></p><figcaption class="figure-caption">(b) Deep-Hit model</figcaption><p></p>
<p><img src="../Figs/FromPy/DeepHit.png" class="img-fluid figure-img" data-ref-parent="fig-fig4"></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-fig4-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p></p><figcaption class="figure-caption">(c) LSTM-model</figcaption><p></p>
<p><img src="../Figs/FromPy/LstmRnn.png" class="img-fluid figure-img" data-ref-parent="fig-fig4"></p>
</figure>
</div>
</div>
</div>
</figure>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="sec-sec6" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Conclusion</h1>
<p>Individuals follow different health trajectories over their lives. Many factors along a health trajectory up to a given time period affect their health state at the time and the future paths that the individual will follows. Such sequential health developments conditioned by the health related behaviors along the path determine the risks of diseases, disability and death. This paper studies statistical and artificial neural network models for predicting time to an event of interest—disability—with death as a competing risk event during the mid ages and how different factors along the health trajectory affect these probabilities. The paper uses the Health and Retirement Study data for estimation of the models. The paper discusses the merits and demerits of these two approaches and compare their performances.</p>
<p>The paper formulates the life histories of individuals as a stochastic process through a finite set of health states. The main problem is to estimate the transition probabilities between health states and the effects of various time varying covariates on transition probabilities. The effect of covariates is parameterized through “transition intensity functions” in both statistical and neural network models. Statistical multistate models assume that in each transition, the covariates linearly affect a latent health measure and that latent health measure shifts a baseline hazard function (or transition intensity function) proportionately up and down by a multiplicative factor. This type of specification of transition intensities is known as Cox proportional hazard model. In many situations, including the present, this proportionality assumption imposes strong structure and could be far from the structure of the true data generating process. The multi layer perceptron (MLP), a kind of deep neural network (explained in the paper), is known to be an excellent `universal function approximator’. Utilizing this insight, recently a few papers use MLP models to relax the proportionality assumption. This paper argues that the prediction of progression through health states and estimation of the probabilities of health events of interest such as disability and death are better done in a recurrent neural network (RNN) model with long-short memory cells to capture the effects of long lagged health related behaviors and outcomes that affect the current and future health outcomes. The paper compares the performances of a statistical multistate model, and an MLP based competing risk model of <span class="citation" data-cites="Lee.etal_2018">Lee et al. (<a href="#ref-Lee.etal_2018" role="doc-biblioref">2018</a>)</span> and the LSTM-RNN model proposed in this paper. The paper finds that performance, measured by c-index, is much better for both the neural network models and is slightly better for the LSTM-RNN model. Since an LSTM-RNN neural model is more suitable for prediction in a sequential set-up, the findings prescribe that it is better to use an LSTM-RNN type of neural network model to estimate and predict transition probabilities than an MLP based neural network model.</p>
<p>For all three models, the paper included some epigenetic factors (that include health related behaviors), demographic factors, education level, some biomarkers like BMI, CESD and cognition and depression and stress level—time varying for the LSTM-RNN and multi-state statistical model and time fixed at the first period for the <span class="citation" data-cites="Lee.etal_2018">Lee et al. (<a href="#ref-Lee.etal_2018" role="doc-biblioref">2018</a>)</span> model. At present there are no neural network software package that can estimate and compare the relative importance of the covariates on transition probabilities. The statistical models are good at that. More research in neural network along this line will be useful.</p>
<p>From the estimates of the statistical model, the paper finds that college graduates have significantly lower probability of all the transitions. The variable CESD measuring the level of depression and stress has significant positive effects on transiting from normal health to diseased health state, from normal health to becoming disabled and from diseased health state to become disabled or to death. The other most significant behavioral variables are smoking and sufficiently vigorous level of regular exercising. The smoking has significantly adverse effects and exercising has favorable effects on most transitions.</p>
<p>For unfamiliar readers, the paper gives introduction to estimation of multistate stochastic models and the MLP and LSTM-RNN type of neural networks models when the data has censored observations.</p>
<p>While a statistical model is good for studying the effects of various covariates on time to event probabilities, judging from the performance based on the c-index, its performance as a predictive model is much worse than the two neural network models considered. Relaxation of the proportionality assumption to include more general specifications is a useful direction. For neural network models, it will be very useful to study the relative strength and statistical significance of various covariates on the outcomes such as transition probabilities through different health states that the models predict.</p>
</section>
<section id="appendix" class="level1 unnumbered">
<h1 class="unnumbered">Appendix</h1>
</section>
<section id="mlp-learning-algorithm" class="level1 unnumbered">
<h1 class="unnumbered">MLP learning algorithm</h1>
<p>The sets of neurons at layer <span class="math inline">\ell=0,1,2</span> are <span class="math inline">N^{0}=\left\{ 1,2,3\right\}</span> corresponding the three inputs, <span class="math inline">N^{1}=\left\{ 1,2,3,4\right\}</span>, i.e.&nbsp;<span class="math inline">4</span> hidden units, and <span class="math inline">N^{L}=\left\{1,2\right\}</span> at the output layer corresponding to <span class="math inline">2</span> outputs. Let <span class="math inline">n^k = \#N^k</span>, i.e., the number of neurons in the k-th layer of the network, for <span class="math inline">k= 0,1,...,L</span>.</p>
<ol type="1">
<li><p>First compute all neuron outputs <span class="math inline">a_{i}^{\ell },</span> <span class="math inline">i\in N^{\ell}</span> using the feedforward iteration: <span class="math inline">a^{\ell }=\sigma ^{\ell }({W^{\ell}a^{l-1}+b^{\ell }}),</span> <span class="math inline">\ell =1,...,L</span>, with initial condition <span class="math inline">a^{0}\equiv x</span> (input vector).</p></li>
<li><p>To calculate <span class="math inline">\frac{\partial C}{\partial w_{ij}^{\ell }}</span>, and <span class="math inline">\frac{\partial C}{\partial b_{i}^{j}}</span>, denote by <span class="math inline">z^{\ell }\equiv W^{\ell}a^{l-1}+b^{\ell }</span> and <span class="math inline">\delta _{i}^{\ell }\equiv \frac{\partial C}{\partial z_{i}^{\ell }}\cdot \sigma ^{\ell \prime }(z^{\ell}_{i})</span>, and calculate first all <span class="math inline">\delta _{i}^{\ell }</span>, <span class="math inline">i\in N^{\ell },\ell =1,2,..., L</span>, using the backpropagation iteration: <span class="math inline">\delta ^{\ell }=W^{\ell +1}\delta ^{l+1}\odot \sigma ^{\ell \prime }(z^{\ell })</span>, <span class="math inline">\ell =L-1,L-2,...,1,</span> with the initial condition <span class="math inline">\delta ^{L}=\frac{\partial C}{\partial a^{L}}\odot \sigma ^{L\prime }(z^{L})</span>, where <span class="math inline">\odot</span> denotes the Haddamard product, i.e., element wise product.</p></li>
<li><p>Now compute <span class="math inline">\frac{\partial C}{\partial b_{i}^{\ell }}=\delta_{i}^{\ell }</span> and <span class="math inline">\frac{\partial C}{\partial w_{ij}^{\ell }}=\delta _{i}^{\ell }a_{j}^{\ell -1}</span>, <span class="math inline">i = 1,2,..., n^{\ell}, j = 1,2,..., , n^{\ell -1}, \ell = 1,2,..., L</span>. In matrix notation, <span class="math inline">\frac{\partial C}{\partial b^{\ell }}=\delta^{\ell }</span> and <span class="math inline">\frac{\partial C}{\partial W^{\ell }}=\delta ^{\ell }a^{\ell -1 `}, \ell = 1,2,..., L</span>.</p></li>
</ol>
</section>
<section id="references" class="level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-Aalen.etal_2008_Book" class="csl-entry" role="doc-biblioentry">
Aalen, Odd O., Ørnulf Borgan, and Håkon K. Gjessing. 2008. <em>Survival and Event History Analysis</em>. Survival Analysis, Stochastic Process. Springer New York. <a href="https://doi.org/10.1007/978-0-387-68560-1">https://doi.org/10.1007/978-0-387-68560-1</a>.
</div>
<div id="ref-Aalen.Johansen_1978" class="csl-entry" role="doc-biblioentry">
Aalen, Odd O., and Søren Johansen. 1978. <span>“An Empirical Transition Matrix for Non-Homogeneous Markov Chains Based on Censored Observations.”</span> Duration, mult-state, counting process. <em>Scandinavian Journal of Statistics</em> 5 (3): 141–50. <a href="http://www.jstor.org/stable/4615704">http://www.jstor.org/stable/4615704</a>.
</div>
<div id="ref-Alisch.etal_2012" class="csl-entry" role="doc-biblioentry">
Alisch, R. S., B. G. Barwick, P. Chopra, L. K. Myrick, G. A. Satten, K. N. Conneely, and S. T. Warren. 2012. <span>“Age-Associated <span>DNA</span> Methylation in Pediatric Populations.”</span> <em>Genome Research</em> 22 (4): 623–32. <a href="https://doi.org/10.1101/gr.125187.111">https://doi.org/10.1101/gr.125187.111</a>.
</div>
<div id="ref-Altae-Tran_2016" class="csl-entry" role="doc-biblioentry">
Altae-Tran, Han. 2016. <span>“<span class="nocase">RNNs for Model Predictive Control in Unknown Dynamical Systems with Low Sampling Rates</span>.”</span> <em>Working Paper, Stanford University</em>.
</div>
<div id="ref-Altae-Tran.etal_2017" class="csl-entry" role="doc-biblioentry">
Altae-Tran, Han, Bharath Ramsundar, Aneesh S. Pappu, and Vijay Pande. 2017. <span>“Low Data Drug Discovery with One-Shot Learning.”</span> <em>ACS Central Science</em> 3 (4): 283–93. <a href="https://doi.org/10.1021/acscentsci.6b00367">https://doi.org/10.1021/acscentsci.6b00367</a>.
</div>
<div id="ref-Andersen.etal_1993_Book" class="csl-entry" role="doc-biblioentry">
Andersen, Per Kragh, Ornulf Borgan, Richard D. Gill, and Niels Keiding. 1993. <em>Statistical Models Based on Counting Processes</em>. Survival Analysis, Multi-state. Springer-Verlag, New York.
</div>
<div id="ref-Andersen.Perme_2008" class="csl-entry" role="doc-biblioentry">
Andersen, Per Kragh, and Maja Pohar Perme. 2008. <span>“Inference for Outcome Probabilities in Multi-State Models.”</span> Duation Analysis. <em>Lifetime Data Analysis</em> 14 (4): 405–31. <a href="https://doi.org/10.1007/s10985-008-9097-x">https://doi.org/10.1007/s10985-008-9097-x</a>.
</div>
<div id="ref-Antolini.etal_2005" class="csl-entry" role="doc-biblioentry">
Antolini, Laura, Patrizia Boracchi, and Elia Biganzoli. 2005. <span>“A Time-Dependent Discrimination Index for Survival Data.”</span> Survival Analysis,C-index. <em>Statistics in Medicine</em> 24 (24): 3927–44. <a href="https://doi.org/10.1002/sim.2427">https://doi.org/10.1002/sim.2427</a>.
</div>
<div id="ref-Austad.Fischer_2016" class="csl-entry" role="doc-biblioentry">
Austad, Steven N., and Kathleen E. Fischer. 2016. <span>“Sex Differences in Lifespan.”</span> <em>Cell Metabolism</em> 23 (6): 1022–33. <a href="https://doi.org/10.1016/j.cmet.2016.05.019">https://doi.org/10.1016/j.cmet.2016.05.019</a>.
</div>
<div id="ref-Barbara.etal_2017" class="csl-entry" role="doc-biblioentry">
Barbara, Maria Andria, Ylenia Abdilla, and Jean Calleja-Agius. 2017. <span>“An Introduction to Epigenetics.”</span> <em>Neonatal Network</em> 36 (3): 124–28. <a href="https://doi.org/10.1891/0730-0832.36.3.124">https://doi.org/10.1891/0730-0832.36.3.124</a>.
</div>
<div id="ref-Barker_1990" class="csl-entry" role="doc-biblioentry">
Barker, David J. P. 1990. <span>“The Fetal and Infant Origins of Adult Disease.”</span> <em>BMJ: British Medical Journal</em> 301 (6761): 1111.
</div>
<div id="ref-Barker_1998" class="csl-entry" role="doc-biblioentry">
———. 1998. <span>“In Utero Programming of Chronic Disease.”</span> <em>Clinical Science</em> 95 (2): 115–28. <a href="https://doi.org/10.1042/cs0950115">https://doi.org/10.1042/cs0950115</a>.
</div>
<div id="ref-Barker_2007" class="csl-entry" role="doc-biblioentry">
———. 2007. <span>“The Origins of the Developmental Origins Theory.”</span> Developmental origin of health. <em>Journal of Internal Medicine</em> 261 (5): 412–17. <a href="https://doi.org/10.1111/j.1365-2796.2007.01809.x">https://doi.org/10.1111/j.1365-2796.2007.01809.x</a>.
</div>
<div id="ref-Barondes_1999_Book" class="csl-entry" role="doc-biblioentry">
Barondes, Samuel. 1999. <em>Molecules and Mental Illness</em>. Scientific American Library.
</div>
<div id="ref-Barres.Zierath_2011" class="csl-entry" role="doc-biblioentry">
Barres, Romain, and Juleen R Zierath. 2011. <span>“<span class="nocase">DNA methylation in metabolic disorders</span>.”</span> <em>The American Journal of Clinical Nutrition</em> 93 (4): 897S–900S. <a href="https://doi.org/10.3945/ajcn.110.001933">https://doi.org/10.3945/ajcn.110.001933</a>.
</div>
<div id="ref-Biganzoli.etal_1998" class="csl-entry" role="doc-biblioentry">
Biganzoli, Elia, Patrizia Boracchi, Luigi Mariani, and Ettore Marubini. 1998. <span>“Feed Forward Neural Networks for the Analysis of Censored Survival Data: A Partial Logistic Regression Approach.”</span> <em>Statistics in Medicine</em> 17 (10): 1169–86. <a href="https://doi.org/10.1002/(SICI)1097-0258(19980530)17:10<1169::AID-SIM796>3.0.CO;2-D">https://doi.org/10.1002/(SICI)1097-0258(19980530)17:10&lt;1169::AID-SIM796&gt;3.0.CO;2-D</a>.
</div>
<div id="ref-Blair.etal_1989" class="csl-entry" role="doc-biblioentry">
Blair, Steven N., III Kohl Harold W., Jr Paffenbarger Ralph S., Debra G. Clark, Kenneth H. Cooper, and Larry W. Gibbons. 1989. <span>“<span class="nocase">Physical Fitness and All-Cause Mortality: A Prospective Study of Healthy Men and Women</span>.”</span> <em><span>JAMA</span></em> 262 (17): 2395–2401. <a href="https://doi.org/10.1001/jama.1989.03430170057028">https://doi.org/10.1001/jama.1989.03430170057028</a>.
</div>
<div id="ref-Boks.etal_2009" class="csl-entry" role="doc-biblioentry">
Boks, Marco P., Eske M. Derks, Daniel J. Weisenberger, Erik Strengman, Esther Janson, Iris E. Sommer, René S. Kahn, and Roel A. Ophoff. 2009. <span>“The Relationship of <span>DNA</span> Methylation with Age, Gender and Genotype in Twins and Healthy Controls.”</span> Edited by Joseph Najbauer. <em><span>PLoS</span> <span>ONE</span></em> 4 (8): e6767. <a href="https://doi.org/10.1371/journal.pone.0006767">https://doi.org/10.1371/journal.pone.0006767</a>.
</div>
<div id="ref-Bookman.etal_2011" class="csl-entry" role="doc-biblioentry">
Bookman, Ebony B., Kimberly McAllister, Elizabeth Gillanders, Kay Wanke, David Balshaw, Joni Rutter, Jill Reedy, et al. 2011. <span>“Gene-Environment Interplay in Common Complex Diseases: Forging an Integrative Model-Recommendations from an NIH Workshop.”</span> <em>Genetic Epidemiology</em>. <a href="https://doi.org/10.1002/gepi.20571">https://doi.org/10.1002/gepi.20571</a>.
</div>
<div id="ref-Bugliari.etal_2016" class="csl-entry" role="doc-biblioentry">
Bugliari, Delia, Nancy Campbell, Chris Chan, Orla Hayden, Michael Hurd, Regan Main, Joshua Mallett, et al. 2016. <span>“<span>RAND HRS</span> Data Documentation, Version p.”</span> Technical report. RAND Center for the Study of Aging. <a href="https://www.rand.org/content/dam/rand/www/external/labor/aging/dataprod/randhrs1992_2014v2.pdf">https://www.rand.org/content/dam/rand/www/external/labor/aging/dataprod/randhrs1992_2014v2.pdf</a>.
</div>
<div id="ref-Commenges_2002" class="csl-entry" role="doc-biblioentry">
Commenges, D. 2002. <span>“Inference for Multi-State Models from Interval-Censored Data.”</span> <em>Statistical Methods in Medical Research</em> 11 (2): 167–82. <a href="https://doi.org/10.1191/0962280202sm279ra">https://doi.org/10.1191/0962280202sm279ra</a>.
</div>
<div id="ref-Conti.etal_2009" class="csl-entry" role="doc-biblioentry">
Conti, Rena M., Ernst R. Berndt, and Richard G. Frank. 2009. <span>“Early Retirement and DI/SSI Applications: Exploring the Impact of Depression.”</span> CESD, HRS, Disability. In <em>Health at Older Ages: The Causes and Consequences of Declining Disability Among the Elderly</em>, 381–408. NBER Chapters. National Bureau of Economic Research, Inc. <a href="http://www.nber.org/chapters/c11120.pdf">http://www.nber.org/chapters/c11120.pdf</a>.
</div>
<div id="ref-Crowther.Lambert_2017" class="csl-entry" role="doc-biblioentry">
Crowther, Michael J., and Paul C. Lambert. 2017. <span>“Parametric Multistate Survival Models: Flexible Modelling Allowing Transition-Specific Distributions with Application to Estimating Clinically Useful Measures of Effect Differences.”</span> Duration, mult-state, parametric. <em>Statistics in Medicine</em> 36 (29): 4719–42. <a href="https://doi.org/10.1002/sim.7448">https://doi.org/10.1002/sim.7448</a>.
</div>
<div id="ref-DiLoreto.Murphy_2015" class="csl-entry" role="doc-biblioentry">
DiLoreto, Race, and Coleen T. Murphy. 2015. <span>“The Cell Biology of Aging.”</span> Biology of Aging. Edited by William Bement. <em>Molecular Biology of the Cell</em> 26 (25): 4524–31. <a href="https://doi.org/10.1091/mbc.e14-06-1084">https://doi.org/10.1091/mbc.e14-06-1084</a>.
</div>
<div id="ref-Elman_1990" class="csl-entry" role="doc-biblioentry">
Elman, Jeffrey L. 1990. <span>“Finding Structure in Time.”</span> <em>Cognitive Science</em> 14 (2): 179–211. <a href="https://doi.org/10.1016/0364-0213(90)90002-E">https://doi.org/10.1016/0364-0213(90)90002-E</a>.
</div>
<div id="ref-Epel.etal_2004" class="csl-entry" role="doc-biblioentry">
Epel, Elissa S., Elizabeth H. Blackburn, Jue Lin, Firdaus S. Dhabhar, Nancy E. Adler, Jason D. Morrow, and Richard M. Cawthon. 2004. <span>“Accelerated Telomere Shortening in Response to Life Stress.”</span> <em>Proceedings of the National Academy of Sciences</em> 101 (49): 17312–15. <a href="https://doi.org/10.1073/pnas.0407162101">https://doi.org/10.1073/pnas.0407162101</a>.
</div>
<div id="ref-Esteller_2008" class="csl-entry" role="doc-biblioentry">
Esteller, Manel. 2008. <span>“Epigenetics in Cancer.”</span> Cancer, Epigenetics. <em>New England Journal of Medicine</em> 358 (11): 1148–59. <a href="https://doi.org/10.1056/nejmra072067">https://doi.org/10.1056/nejmra072067</a>.
</div>
<div id="ref-Faraggi.Simon_1995" class="csl-entry" role="doc-biblioentry">
Faraggi, David, and Richard Simon. 1995. <span>“A Neural Network Model for Survival Data.”</span> Survival Analysis, Neural Network. <em>Statistics in Medicine</em> 14 (1): 73–82. <a href="https://doi.org/10.1002/sim.4780140108">https://doi.org/10.1002/sim.4780140108</a>.
</div>
<div id="ref-Fernandez.etal_2016" class="csl-entry" role="doc-biblioentry">
Fernandez, Tamara, Nicolas Rivera, and Yee Whye Teh. 2016. <span>“Gaussian Processes for Survival Analysis.”</span> Survival Analysis,Survival Filter, Neural Network. In <em>Advances in Neural Information Processing Systems 29</em>, edited by D. D. Lee, M. Sugiyama, U. V. Luxburg, I. Guyon, and R. Garnett, 5021–29. Curran Associates, Inc. <a href="http://papers.nips.cc/paper/6443-gaussian-processes-for-survival-analysis.pdf">http://papers.nips.cc/paper/6443-gaussian-processes-for-survival-analysis.pdf</a>.
</div>
<div id="ref-Fisher.Ryan_2017" class="csl-entry" role="doc-biblioentry">
Fisher, Gwenith G, and Lindsay H Ryan. 2017. <span>“Overview of the Health and Retirement Study and Introduction to the Special Issue.”</span> HRS. Edited by Mo Wang. <em>Work, Aging and Retirement</em> 4 (1): 1–9. <a href="https://doi.org/10.1093/workar/wax032">https://doi.org/10.1093/workar/wax032</a>.
</div>
<div id="ref-Fleming_1978a" class="csl-entry" role="doc-biblioentry">
Fleming, Thomas R. 1978. <span>“Nonparametric Estimation for Nonhomogeneous Markov Processes in the Problem of Competing Risks.”</span> Duration, mult-state, counting process. <em>The Annals of Statistics</em> 6 (5): 1057–70. <a href="http://www.jstor.org/stable/2958608">http://www.jstor.org/stable/2958608</a>.
</div>
<div id="ref-Fleming_Harrington_2005_Book" class="csl-entry" role="doc-biblioentry">
Fleming, Thomas R., and David P. Harrington. 2005. <em>Counting Processes and Survival Analysis</em>. Survival Analysis, Stochastic Process. Wiley.
</div>
<div id="ref-Gill_2005" class="csl-entry" role="doc-biblioentry">
Gill, Richard D. 2005. <span>“Product-Integration.”</span> In <em>Encyclopedia of Biostatistics</em>. American Cancer Society. <a href="https://doi.org/10.1002/0470011815.b2a11058">https://doi.org/10.1002/0470011815.b2a11058</a>.
</div>
<div id="ref-Gill.Johansen_1990" class="csl-entry" role="doc-biblioentry">
Gill, Richard D., and Soren Johansen. 1990. <span>“A Survey of Product-Integration with a View Toward Application in Survival Analysis.”</span> <em>The Annals of Statistics</em> 18 (4): 1501–55. <a href="http://www.jstor.org/stable/2241874">http://www.jstor.org/stable/2241874</a>.
</div>
<div id="ref-Gluckman.etal_2008" class="csl-entry" role="doc-biblioentry">
Gluckman, Peter D., Mark A. Hanson, Cyrus Cooper, and Kent L. Thornburg. 2008. <span>“Effect of in Utero and Early-Life Conditions on Adult Health and Disease.”</span> Early Childhood events, Health, Epigenetics. <em>New England Journal of Medicine</em> 359 (1): 61–73. <a href="https://doi.org/10.1056/nejmra0708473">https://doi.org/10.1056/nejmra0708473</a>.
</div>
<div id="ref-Graves_2012_Book" class="csl-entry" role="doc-biblioentry">
Graves, Alex. 2012. <em>Supervised Sequence Labelling with Recurrent Neural Networks</em>. Machine Learning, RNN. Springer Berlin Heidelberg. <a href="https://doi.org/10.1007/978-3-642-24797-2">https://doi.org/10.1007/978-3-642-24797-2</a>.
</div>
<div id="ref-Graves.etal_2014" class="csl-entry" role="doc-biblioentry">
Graves, Alex, Greg Wayne, and Ivo Danihelka. 2014. <span>“Neural Turing Machines.”</span> <em>CoRR</em> abs/1410.5401. <a href="http://arxiv.org/abs/1410.5401">http://arxiv.org/abs/1410.5401</a>.
</div>
<div id="ref-Hammer_2000" class="csl-entry" role="doc-biblioentry">
Hammer, Barbara. 2000. <span>“On the Approximation Capability of Recurrent Neural Networks.”</span> <em>Neurocomputing</em> 31 (1): 107–23. https://doi.org/<a href="https://doi.org/10.1016/S0925-2312(99)00174-5">https://doi.org/10.1016/S0925-2312(99)00174-5</a>.
</div>
<div id="ref-Hannum.etal_2013" class="csl-entry" role="doc-biblioentry">
Hannum, Gregory, Justin Guinney, Ling Zhao, Li Zhang, Guy Hughes, SriniVas Sadda, Brandy Klotzle, et al. 2013. <span>“Genome-Wide Methylation Profiles Reveal Quantitative Views of Human Aging Rates.”</span> Biological Age measure. <em>Molecular Cell</em> 49 (2): 359–67. <a href="https://doi.org/10.1016/j.molcel.2012.10.016">https://doi.org/10.1016/j.molcel.2012.10.016</a>.
</div>
<div id="ref-Harrell.etal_1982" class="csl-entry" role="doc-biblioentry">
Harrell, Jr, Frank E., Robert M. Califf, David B. Pryor, Kerry L. Lee, and Robert A. Rosati. 1982. <span>“Evaluating the Yield of Medical Tests.”</span> <em>JAMA</em> 247 (18): 2543–46. <a href="https://doi.org/10.1001/jama.1982.03320430047030">https://doi.org/10.1001/jama.1982.03320430047030</a>.
</div>
<div id="ref-Hayflick_1965" class="csl-entry" role="doc-biblioentry">
Hayflick, L. 1965. <span>“The Limited in Vitro Lifetime of Human Diploid Cell Strains.”</span> <em>Experimental Cell Research</em> 37 (3): 614–36. <a href="https://doi.org/10.1016/0014-4827(65)90211-9">https://doi.org/10.1016/0014-4827(65)90211-9</a>.
</div>
<div id="ref-Hochreiter.Schmidhuber_1997" class="csl-entry" role="doc-biblioentry">
Hochreiter, Sepp, and Jürgen Schmidhuber. 1997. <span>“Long Short-Term Memory.”</span> RNN,LSTM, Neuralnet. <em>Neural Computation</em> 9 (8): 1735–80. <a href="https://doi.org/10.1162/neco.1997.9.8.1735">https://doi.org/10.1162/neco.1997.9.8.1735</a>.
</div>
<div id="ref-Hornik.etal_1989" class="csl-entry" role="doc-biblioentry">
Hornik, Kurt, Maxwell Stinchcombe, and Halbert White. 1989. <span>“Multilayer Feedforward Networks Are Universal Approximators.”</span> <em>Neural Networks</em> 2 (5): 359â€“366. <a href="https://doi.org/10.1016/0893-6080(89)90020-8">https://doi.org/10.1016/0893-6080(89)90020-8</a>.
</div>
<div id="ref-Horvath_2013" class="csl-entry" role="doc-biblioentry">
Horvath, Steve. 2013. <span>“DNA Methylation Age of Human Tissues and Cell Types.”</span> Biological Age measure. <em>Genome Biology</em> 14 (10): 3156. <a href="https://doi.org/10.1186/gb-2013-14-10-r115">https://doi.org/10.1186/gb-2013-14-10-r115</a>.
</div>
<div id="ref-Juster.Suzman_1995" class="csl-entry" role="doc-biblioentry">
Juster, F. Thomas, and Richard Suzman. 1995. <span>“An Overview of the Health and Retirement Study.”</span> HRS, overview. <em>The Journal of Human Resources</em> 30: S7. <a href="https://doi.org/10.2307/146277">https://doi.org/10.2307/146277</a>.
</div>
<div id="ref-Kanherkar.etal_2014" class="csl-entry" role="doc-biblioentry">
Kanherkar, Riya R., Naina Bhatia-Dey, and Antonei B. Csoka. 2014. <span>“Epigenetics Across the Human Lifespan.”</span> <em>Frontiers in Cell and Developmental Biology</em> 2 (3): 124–28. <a href="https://doi.org/10.3389/fcell.2014.00049">https://doi.org/10.3389/fcell.2014.00049</a>.
</div>
<div id="ref-Kaplan.Meier_1958" class="csl-entry" role="doc-biblioentry">
Kaplan, E. L., and Paul Meier. 1958. <span>“Nonparametric Estimation from Incomplete Observations.”</span> <em>Journal of the American Statistical Association</em> 53 (282): 457–81. <a href="https://doi.org/10.1080/01621459.1958.10501452">https://doi.org/10.1080/01621459.1958.10501452</a>.
</div>
<div id="ref-Karakus.Patton_2011" class="csl-entry" role="doc-biblioentry">
Karakus, Mustafa C., and Lisa C. Patton. 2011. <span>“Depression and the Onset of Chronic Illness in Older Adults: A 12-Year Prospective Study.”</span> <em>The Journal of Behavioral Health Services <span>&amp;</span> Research</em> 38 (3): 373–82. <a href="https://doi.org/10.1007/s11414-011-9234-2">https://doi.org/10.1007/s11414-011-9234-2</a>.
</div>
<div id="ref-Katzman.etal_2018" class="csl-entry" role="doc-biblioentry">
Katzman, Jared L., Uri Shaham, Alexander Cloninger, Jonathan Bates, Tingting Jiang, and Yuval Kluger. 2018. <span>“DeepSurv: Personalized Treatment Recommender System Using a Cox Proportional Hazards Deep Neural Network.”</span> Survival Analysis,Survival Filter, Neural Network. <em>BMC Medical Research Methodology</em> 18 (1): 24. <a href="https://doi.org/10.1186/s12874-018-0482-1">https://doi.org/10.1186/s12874-018-0482-1</a>.
</div>
<div id="ref-Khoury.etal_2009" class="csl-entry" role="doc-biblioentry">
Khoury, Muin J., Lars Bertram, Paolo Boffetta, Adam S. Butterworth, Stephen J. Chanock, Siobhan M. Dolan, Isabel Fortier, et al. 2009. <span>“<span class="nocase">Genome-Wide Association Studies, Field Synopses, and the Development of the Knowledge Base on Genetic Variation and Human Diseases</span>.”</span> <em>American Journal of Epidemiology</em> 170 (3): 269–79. <a href="https://doi.org/10.1093/aje/kwp119">https://doi.org/10.1093/aje/kwp119</a>.
</div>
<div id="ref-Lee.etal_2018" class="csl-entry" role="doc-biblioentry">
Lee, Changhee, William R Zame, Jinsung Yoon, and Mihaela van der Schaar. 2018. <span>“Deephit: A Deep Learning Approach to Survival Analysis with Competing Risks.”</span> Survival Analysis,DeepHit, Neural Network. In <em>Thirty-Second AAAI Conference on Artificial Intelligence</em>. <a href="https://www.aaai.org/ocs/index.php/AAAI/AAAI18/paper/viewPaper/16160">https://www.aaai.org/ocs/index.php/AAAI/AAAI18/paper/viewPaper/16160</a>.
</div>
<div id="ref-Lipton.etal_2015a" class="csl-entry" role="doc-biblioentry">
Lipton, Zachary C., John Berkowitz, and Charles Elkan. 2015. <span>“A Critical Review of Recurrent Neural Networks for Sequence Learning.”</span> Neuralnet, Survey. <em>arXiv Preprint</em>.
</div>
<div id="ref-Ranganath.etal_2016" class="csl-entry" role="doc-biblioentry">
Ranganath, Rajesh, Adler Perotte, Noémie Elhadad, and David Blei. 2016. <span>“Deep Survival Analysis.”</span> Survival Analysis,Survival Filter, Neural Network. PMLR. <a href="http://proceedings.mlr.press/v56/Ranganath16.pdf">http://proceedings.mlr.press/v56/Ranganath16.pdf</a>.
</div>
<div id="ref-Raut_2017b" class="csl-entry" role="doc-biblioentry">
Raut, Lakshmi K. 2017. <span>“Exits from Disability: Estimates from a Competing Risk Model.”</span> Published. <em>Social Security Bulletin</em> 77 (3): 15–38. <a href="https://www.ssa.gov/policy/docs/ssb/v77n3/v77n3p15.html">https://www.ssa.gov/policy/docs/ssb/v77n3/v77n3p15.html</a>.
</div>
<div id="ref-Raut_2019" class="csl-entry" role="doc-biblioentry">
———. 2019a. <span>“Pathways to Disability and Mortality in Mid-Ages: Estimates from the Health and Retirement Study Data.”</span> Working: SSA. <em>Draft Presented at the 2019 SGE Annual Conference</em>.
</div>
<div id="ref-Raut_2019a" class="csl-entry" role="doc-biblioentry">
———. 2019b. <span>“Progression of Health, Mortality and Morbidy in the Aging Process: Genetics, Epigenetics and Fetal Programming.”</span> Working: Disability. <em>(Mimeo) University of Chicago</em>.
</div>
<div id="ref-Ren.etal_2019" class="csl-entry" role="doc-biblioentry">
Ren, Kan, Jiarui Qin, Lei Zheng, Zhengyu Yang, Weinan Zhang, Lin Qiu, and Yong Yu. 2019. <span>“Deep Recurrent Survival Analysis.”</span> Survival Analysis,RNN, Neural Network. In <em>Proc. AAAI</em>, 1–8. <a href="https://arxiv.org/pdf/1809.02403.pdf">https://arxiv.org/pdf/1809.02403.pdf</a>.
</div>
<div id="ref-Renna_2008" class="csl-entry" role="doc-biblioentry">
Renna, Francesco. 2008. <span>“Alcohol Abuse, Alcoholism, and Labor Market Outcomes: Looking for the Missing Link.”</span> <em><span>ILR</span> Review</em> 62 (1): 92–103. <a href="https://doi.org/10.1177/001979390806200105">https://doi.org/10.1177/001979390806200105</a>.
</div>
<div id="ref-Seib.etal_2014" class="csl-entry" role="doc-biblioentry">
Seib, Charrlotte, Eliza Whiteside, Kathryn Lee, Janice Humphreys, Tiet Hanh Dao Tran, Lisa Chopin, and Debra Anderson. 2014. <span>“Stress, Lifestyle, and Quality of Life in Midlife and Older Australian Women: Results from the Stress and the Health of Women Study.”</span> <em>Women’s Health Issues</em> 24 (1): e43–52. <a href="https://doi.org/10.1016/j.whi.2013.11.004">https://doi.org/10.1016/j.whi.2013.11.004</a>.
</div>
<div id="ref-Shalev.Belsky_2016" class="csl-entry" role="doc-biblioentry">
Shalev, Idan, and Jay Belsky. 2016. <span>“Early-Life Stress and Reproductive Cost: A Two-Hit Developmental Model of Accelerated Aging?”</span> Ageing Biology, Genetics,Neuroscience. <em>Medical Hypotheses</em> 90: 41–47. <a href="https://doi.org/10.1016/j.mehy.2016.03.002">https://doi.org/10.1016/j.mehy.2016.03.002</a>.
</div>
<div id="ref-Shalev.etal_2013" class="csl-entry" role="doc-biblioentry">
Shalev, Idan, Sonja Entringer, Pathik D. Wadhwa, Owen M. Wolkowitz, Eli Puterman, Jue Lin, and Elissa S. Epel. 2013. <span>“Stress and Telomere Biology: A Lifespan Perspective.”</span> <em>Psychoneuroendocrinology</em> 38 (9): 1835–42. <a href="https://doi.org/10.1016/j.psyneuen.2013.03.010">https://doi.org/10.1016/j.psyneuen.2013.03.010</a>.
</div>
<div id="ref-Siegelmann.Sontag_1992" class="csl-entry" role="doc-biblioentry">
Siegelmann, Hava T., and Eduardo D. Sontag. 1992. <span>“On the Computational Power of Neural Nets.”</span> In <em>Proceedings of the Fifth Annual Workshop on Computational Learning Theory - <span>COLT</span> <span></span>92</em>. <span>ACM</span> Press. <a href="https://doi.org/10.1145/130385.130432">https://doi.org/10.1145/130385.130432</a>.
</div>
<div id="ref-Simons.etal_2016" class="csl-entry" role="doc-biblioentry">
Simons, Ronald L., Man Kit Lei, Steven R. H. Beach, Robert A. Philibert, Carolyn E. Cutrona, Frederick X. Gibbons, and Ashley Barr. 2016. <span>“Economic Hardship and Biological Weathering: The Epigenetics of Aging in a u.s. Sample of Black Women.”</span> Ageing Biology, Genetics,Neuroscience. <em>Social Science &amp; Medicine</em> 150: 192–200. <a href="https://doi.org/10.1016/j.socscimed.2015.12.001">https://doi.org/10.1016/j.socscimed.2015.12.001</a>.
</div>
<div id="ref-Sonnega.etal_2014" class="csl-entry" role="doc-biblioentry">
Sonnega, A., J. D. Faul, M. B. Ofstedal, K. M. Langa, J. W. Phillips, and D. R. Weir. 2014. <span>“Cohort Profile: The Health and Retirement Study (<span>HRS</span>).”</span> <em>International Journal of Epidemiology</em> 43 (2): 576–85. <a href="https://doi.org/10.1093/ije/dyu067">https://doi.org/10.1093/ije/dyu067</a>.
</div>
<div id="ref-Steffick_2000" class="csl-entry" role="doc-biblioentry">
Steffick, Diane E. 2000. <span>“Documentation of Affective Functioning Measures in the Health and Retirement Study.”</span> <em>Ann Arbor, MI: University of Michigan</em>. <a href="http://hrsonline.isr.umich.edu/sitedocs/userg/dr-005.pdf">http://hrsonline.isr.umich.edu/sitedocs/userg/dr-005.pdf</a>.
</div>
<div id="ref-Thornburg.etal_2010" class="csl-entry" role="doc-biblioentry">
Thornburg, Kent L., Jackilen Shannon, Philippe Thuillier, and Mitchell S. Turker. 2010. <span>“In Utero Life and Epigenetic Predisposition for Disease.”</span> Early Childhood events, Health, Epigenetics. In <em>Epigenetics and Cancer, Part b</em>, 57–78. Elsevier. <a href="https://doi.org/10.1016/b978-0-12-380864-6.00003-1">https://doi.org/10.1016/b978-0-12-380864-6.00003-1</a>.
</div>
<div id="ref-Vaupel_2010" class="csl-entry" role="doc-biblioentry">
Vaupel, James W. 2010. <span>“Biodemography of Human Ageing.”</span> <em>Nature</em> 464 (7288): 536–42. <a href="https://doi.org/10.1038/nature08984">https://doi.org/10.1038/nature08984</a>.
</div>
<div id="ref-Wreede.etal_2010" class="csl-entry" role="doc-biblioentry">
Wreede, Liesbeth C. de, Marta Fiocco, and Hein Putter. 2010. <span>“The Mstate Package for Estimation and Prediction in Non- and Semi-Parametric Multi-State and Competing Risks Models.”</span> Duation Analysis. <em>Computer Methods and Programs in Biomedicine</em> 99 (3): 261–74. <a href="https://doi.org/10.1016/j.cmpb.2010.01.001">https://doi.org/10.1016/j.cmpb.2010.01.001</a>.
</div>
<div id="ref-Zarulli.etal_2018" class="csl-entry" role="doc-biblioentry">
Zarulli, Virginia, Julia A. Barthold Jones, Anna Oksuzyan, Rune Lindahl-Jacobsen, Kaare Christensen, and James W. Vaupel. 2018. <span>“Women Live Longer Than Men Even During Severe Famines and Epidemics.”</span> <em>Proceedings of the National Academy of Sciences</em> 115 (4): E832–40. <a href="https://doi.org/10.1073/pnas.1701535115">https://doi.org/10.1073/pnas.1701535115</a>.
</div>
<div id="ref-Zhao.etal_2019" class="csl-entry" role="doc-biblioentry">
Zhao, Rui, Ruqiang Yan, Zhenghua Chen, Kezhi Mao, Peng Wang, and Robert X. Gao. 2019. <span>“Deep Learning and Its Applications to Machine Health Monitoring.”</span> Survival Analysis,Survival Filter, Neural Network. <em>Mechanical Systems and Signal Processing</em> 115: 213–37. <a href="https://doi.org/10.1016/j.ymssp.2018.05.050">https://doi.org/10.1016/j.ymssp.2018.05.050</a>.
</div>
</div>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>See for instance, <span class="citation" data-cites="Raut_2017b">Raut (<a href="#ref-Raut_2017b" role="doc-biblioref">2017</a>)</span> for a competing risk analysis in a similar context using the SSA Administrative data and compare that with the present framework.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p> From definition of transition intensities above and writing it in matrix form, we have <span class="math inline">\Gamma \left( t\right) =\lim_{\Delta t\downarrow 0}\frac{ P\left( t,t+\Delta t\right) -P\left( t,t\right) }{\Delta t}=\lim_{\Delta t\downarrow 0}\frac{P\left( t,t+\Delta t\right) -I}{\Delta t}</span>. From this it follows that for small <span class="math inline">\Delta t</span>, we have <span class="math inline">P\left( t,t+\Delta t\right) = I +\Gamma (t) \Delta t</span>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>For more formal treatment of product integral see <span class="citation" data-cites="Gill.Johansen_1990">Gill and Johansen (<a href="#ref-Gill.Johansen_1990" role="doc-biblioref">1990</a>)</span> and for a lucid exposition with some applications, see <span class="citation" data-cites="Gill_2005">Gill (<a href="#ref-Gill_2005" role="doc-biblioref">2005</a>)</span>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>